!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(xd){"use strict";try{(function(){xd=xd&&Object.prototype.hasOwnProperty.call(xd,"default")?xd.default:xd;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},k=_||self;function D(){}function P(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),L=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:V).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++L))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var $=k.navigator;if($){var J=$.userAgent;if(J){W=J;break t}}W=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=D;var it,ot,st=X(W,"Opera"),ut=X(W,"Trident")||X(W,"MSIE"),at=X(W,"Edge"),ht=at||ut,ct=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ft=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function lt(){var t=k.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=W,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=k.document&&ut?lt()||(parseInt(it,10)||void 0):void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",D,e),k.removeEventListener("test",D,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},q(Tt,It);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Rt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[At]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[At]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=qt(t);if(h||(t[Ot]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Pt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(Pt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):kt(t)))}function Mt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(wt)return Ut(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new Tt(e,this))}function qt(t){return(t=t[Ot])instanceof Dt?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==P(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new Dt(this),(this.J=this).C=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Pt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(Gt,F),Gt.prototype[At]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=k.JSON.stringify;function Kt(){this.b=this.a=null}var Wt,Qt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Yt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function $t(t,e){var n;Wt||(n=k.Promise.resolve(void 0),Wt=function(){n.then(te)}),Jt||(Wt(),Jt=!0),Zt.add(t,e)}Kt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Kt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||k,this.f=M(this.Ya,this),this.g=j()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==P(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}q(ee,Gt),(A=ee.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},A.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie,oe,se,ue=(T(oe=he,se=ie=F),oe.prototype=null===se?Object.create(se):(ae.prototype=se.prototype,new ae),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){ie.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ae(){this.constructor=oe}function he(t,e,n){var r=ie.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ce(t){F.call(this),this.b=t,this.a={}}q(ce,F);var fe=[];function le(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Gt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Te(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}q(me,It),q(be,It),q(Ie,It);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}_e.prototype.a=null;var De,Pe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function xe(){It.call(this,"d")}function Oe(){It.call(this,"c")}function Re(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ce(this),this.P=Ce,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(xe,It),q(Oe,It),q(Re,_e),De=new Re;var Ce=45e3,Ve={},Me={};function Ue(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Fe(t),t.l=Ze(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),wn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(M(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function qe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ve:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ee(14),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ve){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Ee(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ir(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),ze(t))}function Fe(t){t.U=j()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(M(t.Ua,t),e)}function Ge(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ur(t.g,t)}function He(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;sr(p),Xn(p)}rr(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(M(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||sr(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(X(u,"spdy")||X(u,"quic")||X(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Sn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fr(o,o.C?o.ga:null,o.fa),c.C?(kn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Ge(f),Fe(f)),o.a=c):nr(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||r<=0?3:2),Ge(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,f=this.l,l=this.f,p=this.T,d=e,y=i,h.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+p+"]: "+c+"\n"+f+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ee(12),He(this),ze(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,a)}this.I?(qe(this,e,o),ht&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),Ke(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?ur(this.g,this):(this.b=!1,Fe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),He(this),ze(this)}}}catch(t){}var h,c,f,l,p,d,y},A.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),qe(this,t,e),this.b&&4!=t&&Fe(this)))},A.cancel=function(){this.A=!0,He(this)},A.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),He(this),this.h=2,ze(this)):Be(this,this.U-n)},(A=Qe.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Xe(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function Ze(t){return new Je(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(vn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},r)),r.f=i):(n||(e=an(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,dn)),t.join("")};var cn=/[#\/\?@]/g,fn=/[#\?:]/g,ln=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function mn(t,e){return vn(t),e=bn(t,e),Ye(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),H(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||Tn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){vn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Sn(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Pn(){}function xn(){this.a=new Pn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Rn=k.JSON.parse;function Ln(t){Gt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}q(Ln,Gt);var Cn="",Vn=/^https?$/i,Mn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),Bn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",qn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,on(n=Ze(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),tr(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=j(),Fe(e)),cr(t)}function Xn(t){t.a&&(ir(t),t.a.cancel(),t.a=null)}function Yn(t){Xn(t),t.j&&(k.clearTimeout(t.j),t.j=null),sr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Nn(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.P),tr(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=er(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sn(t.b,n),Ue(n,r,e)}function tr(t,n){t.f&&We({},function(t,e){on(n,e,t)})}function er(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;O(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function nr(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function rr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(M(t.Aa,t),ar(t,t.o)),t.o++,1)}function ir(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function or(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),tr(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,je(n,t)}function sr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ur(t,e){var n,r=null;if(t.a==e){sr(t),ir(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=ge()).dispatchEvent(new Ie(i)),Jn(t)):nr(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(M(t.Ba,t,e),ar(t,t.u)),t.u++,1}}(t,e)||2==i&&rr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function ar(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||tn(n,"https"),sn(n)),i=n.toString(),o=r,u=new de,k.Image?((s=new Image).onload=U(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=U(On,u,s,"TestLoadImage: error",!1,o),s.onabort=U(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(On,u,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function fr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Je?Ze(r):new Je(r,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(i=k.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Je(null,void 0),o&&tn(h,o),s&&en(h,s),u&&nn(h,u),a&&(h.g=a),c=h),t.W&&Z(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),tr(t,c),c}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function pr(){}function dr(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Gt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mr(this)}function vr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Oe.call(this),this.status=1}function mr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(De),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,ut&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Fn(this):this.Ta())},A.Ta=function(){Fn(this)},A.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Wn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=er(this,n,e),on(i=Ze(this.B),"RID",t),on(i,"CVER",22),this.A&&on(i,"X-HTTP-Session-Id",this.A),tr(this,i),this.i&&r&&Hn(i,this.i,r),Sn(this.b,n),this.Ga&&on(i,"TYPE","init"),this.da?(on(i,"$req",e),on(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||Nn(this.b)||Zn(this))},A.Aa=function(){var t;this.j=null,or(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(M(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),or(this))},A.Ra=function(){null!=this.m&&(this.m=null,Xn(this),rr(this),Ee(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(A=pr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},dr.prototype.a=function(t,e){return new yr(t,e)},q(yr,Gt),(A=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=fr(t,null,t.fa),Jn(t)},A.close=function(){Qn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,yr.S.G.call(this)},q(vr,xe),q(gr,Oe),q(mr,pr),mr.prototype.ta=function(){this.a.dispatchEvent("a")},mr.prototype.sa=function(t){this.a.dispatchEvent(new vr(t))},mr.prototype.ra=function(t){this.a.dispatchEvent(new gr)},mr.prototype.qa=function(){this.a.dispatchEvent("b")},dr.prototype.createWebChannel=dr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Ae.COMPLETE="complete",(ke.EventType=Pe).OPEN="a",Pe.CLOSE="b",Pe.ERROR="c",Pe.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var wr={createWebChannelTransport:function(){return new dr},ErrorCode:Ne,EventType:Ae,WebChannel:ke,XhrIo:Ln},br=wr.createWebChannelTransport,Er=wr.ErrorCode,Ir=wr.EventType,Tr=wr.WebChannel,Nr=wr.XhrIo,Ar=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Sr=new c("@firebase/firestore");function kr(){return Sr.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.DEBUG&&(e=n.map(Or),Sr.debug.apply(Sr,i(["Firestore (7.17.2): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.ERROR&&(e=n.map(Or),Sr.error.apply(Sr,i(["Firestore (7.17.2): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.WARN&&(e=n.map(Or),Sr.warn.apply(Sr,i(["Firestore (7.17.2): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.2) INTERNAL ASSERTION FAILED: "+t;throw Pr(e),new Error(e)}function Lr(t){t||Rr()}var Cr=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Mr(t,e){return t<e?-1:e<t?1:0}function Ur(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function jr(t){return t+"\0"}function qr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Fr=(Object.defineProperty(Br.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Br.prototype.isEqual=function(t){return t instanceof Br&&t.projectId===this.projectId&&t.database===this.database},Br.prototype.o=function(t){return Mr(this.projectId,t.projectId)||Mr(this.database,t.database)},Br);function Br(t,e){this.projectId=t,this.database=e||"(default)"}function Gr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Hr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Kr,Wr,Qr,Xr=(li.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},li.prototype.has=function(t){return void 0!==this.get(t)},li.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},li.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},li.prototype.forEach=function(u){zr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},li.prototype._=function(){return Hr(this.l)},li),Yr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$r=(n(fi,Qr=Error),fi),Jr=(ci.now=function(){return ci.fromMillis(Date.now())},ci.fromDate=function(t){return ci.fromMillis(t.getTime())},ci.fromMillis=function(t){var e=Math.floor(t/1e3);return new ci(e,1e6*(t-1e3*e))},ci.prototype.toDate=function(){return new Date(this.toMillis())},ci.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ci.prototype.T=function(t){return this.seconds===t.seconds?Mr(this.nanoseconds,t.nanoseconds):Mr(this.seconds,t.seconds)},ci.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ci.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ci.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ci),Zr=(hi.I=function(t){return new hi(t)},hi.min=function(){return new hi(new Jr(0,0))},hi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},hi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},hi.prototype.A=function(){return this.timestamp},hi),ti=(Object.defineProperty(ai.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ai.prototype.isEqual=function(t){return 0===ai.P(this,t)},ai.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ai?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ai.prototype.limit=function(){return this.offset+this.length},ai.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ai.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ai.prototype.v=function(){return this.segments[this.offset]},ai.prototype.S=function(){return this.get(this.length-1)},ai.prototype.get=function(t){return this.segments[this.offset+t]},ai.prototype._=function(){return 0===this.length},ai.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ai.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ai.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ai),ei=(n(ui,Wr=ti),ui.prototype.g=function(t,e,n){return new ui(t,e,n)},ui.prototype.N=function(){return this.F().join("/")},ui.prototype.toString=function(){return this.N()},ui.k=function(t){if(0<=t.indexOf("//"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ui(t.split("/").filter(function(t){return 0<t.length}))},ui.$=function(){return new ui([])},ui),ni=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ri=(n(si,Kr=ti),si.prototype.g=function(t,e,n){return new si(t,e,n)},si.M=function(t){return ni.test(t)},si.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),si.M(t)||(t="`"+t+"`"),t}).join(".")},si.prototype.toString=function(){return this.N()},si.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},si.L=function(){return new si(["__name__"])},si.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $r(Yr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new $r(Yr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new si(e)},si.$=function(){return new si([])},si),ii=(oi.B=function(t){return new oi(ei.k(t).V(5))},oi.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},oi.prototype.isEqual=function(t){return null!==t&&0===ei.P(this.path,t.path)},oi.prototype.toString=function(){return this.path.toString()},oi.P=function(t,e){return ei.P(t.path,e.path)},oi.W=function(t){return t.length%2==0},oi.j=function(t){return new oi(new ei(t.slice()))},oi);function oi(t){this.path=t}function si(){return null!==Kr&&Kr.apply(this,arguments)||this}function ui(){return null!==Wr&&Wr.apply(this,arguments)||this}function ai(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.R=n}function hi(t){this.timestamp=t}function ci(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function fi(t,e){var n=this;return(n=Qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function li(t,e){this.h=t,this.u=e,this.l={}}function pi(t){return null==t}function di(t){return-0===t&&1/t==-1/0}function yi(t){return"number"==typeof t&&Number.isInteger(t)&&!di(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function mi(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+Eo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),pi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ku(n.startAt)),n.endAt&&(e+="|ub:",e+=Ku(n.endAt)),n.K=e),n.K}function wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qu(t.startAt,e.startAt)&&Qu(t.endAt,e.endAt)}function bi(t){return ii.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ei=(Ii.fromBase64String=function(t){return new Ii(atob(t))},Ii.fromUint8Array=function(t){return new Ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ii.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ii.prototype.H=function(){return 2*this.G.length},Ii.prototype.o=function(t){return Mr(this.G,t.G)},Ii.prototype.isEqual=function(t){return this.G===t.G},Ii);function Ii(t){this.G=t}Ei.Y=new Ei("");function Ti(t){this.count=t}var Ni,Ai,_i=(Si.prototype.Z=function(t){return new Si(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Si.prototype.tt=function(t,e){return new Si(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Si.prototype.et=function(t){return new Si(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},Si);function Si(t,e,n,r,i,o,s){void 0===i&&(i=Zr.min()),void 0===o&&(o=Zr.min()),void 0===s&&(s=Ei.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case Yr.OK:return Rr(),0;case Yr.CANCELLED:case Yr.UNKNOWN:case Yr.DEADLINE_EXCEEDED:case Yr.RESOURCE_EXHAUSTED:case Yr.INTERNAL:case Yr.UNAVAILABLE:case Yr.UNAUTHENTICATED:return;case Yr.INVALID_ARGUMENT:case Yr.NOT_FOUND:case Yr.ALREADY_EXISTS:case Yr.PERMISSION_DENIED:case Yr.FAILED_PRECONDITION:case Yr.ABORTED:case Yr.OUT_OF_RANGE:case Yr.UNIMPLEMENTED:case Yr.DATA_LOSS:return 1;default:return Rr(),0}}function Di(t){if(void 0===t)return Pr("GRPC error has no .code"),Yr.UNKNOWN;switch(t){case Ni.OK:return Yr.OK;case Ni.CANCELLED:return Yr.CANCELLED;case Ni.UNKNOWN:return Yr.UNKNOWN;case Ni.DEADLINE_EXCEEDED:return Yr.DEADLINE_EXCEEDED;case Ni.RESOURCE_EXHAUSTED:return Yr.RESOURCE_EXHAUSTED;case Ni.INTERNAL:return Yr.INTERNAL;case Ni.UNAVAILABLE:return Yr.UNAVAILABLE;case Ni.UNAUTHENTICATED:return Yr.UNAUTHENTICATED;case Ni.INVALID_ARGUMENT:return Yr.INVALID_ARGUMENT;case Ni.NOT_FOUND:return Yr.NOT_FOUND;case Ni.ALREADY_EXISTS:return Yr.ALREADY_EXISTS;case Ni.PERMISSION_DENIED:return Yr.PERMISSION_DENIED;case Ni.FAILED_PRECONDITION:return Yr.FAILED_PRECONDITION;case Ni.ABORTED:return Yr.ABORTED;case Ni.OUT_OF_RANGE:return Yr.OUT_OF_RANGE;case Ni.UNIMPLEMENTED:return Yr.UNIMPLEMENTED;case Ni.DATA_LOSS:return Yr.DATA_LOSS;default:return Rr()}}(Ai=Ni=Ni||{})[Ai.OK=0]="OK",Ai[Ai.CANCELLED=1]="CANCELLED",Ai[Ai.UNKNOWN=2]="UNKNOWN",Ai[Ai.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ai[Ai.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ai[Ai.NOT_FOUND=5]="NOT_FOUND",Ai[Ai.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ai[Ai.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ai[Ai.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ai[Ai.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ai[Ai.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ai[Ai.ABORTED=10]="ABORTED",Ai[Ai.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ai[Ai.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ai[Ai.INTERNAL=13]="INTERNAL",Ai[Ai.UNAVAILABLE=14]="UNAVAILABLE",Ai[Ai.DATA_LOSS=15]="DATA_LOSS";var Pi=(Ci.prototype.nt=function(t,e){return new Ci(this.P,this.root.nt(t,e,this.P).copy(null,null,Oi.st,null,null))},Ci.prototype.remove=function(t){return new Ci(this.P,this.root.remove(t,this.P).copy(null,null,Oi.st,null,null))},Ci.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ci.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ci.prototype._=function(){return this.root._()},Object.defineProperty(Ci.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ci.prototype.it=function(){return this.root.it()},Ci.prototype.rt=function(){return this.root.rt()},Ci.prototype.ot=function(t){return this.root.ot(t)},Ci.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ci.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ci.prototype.ht=function(t){return this.root.ht(t)},Ci.prototype.at=function(){return new xi(this.root,null,this.P,!1)},Ci.prototype.ut=function(t){return new xi(this.root,t,this.P,!1)},Ci.prototype.ct=function(){return new xi(this.root,null,this.P,!0)},Ci.prototype.lt=function(t){return new xi(this.root,t,this.P,!0)},Ci),xi=(Li.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Li.prototype.wt=function(){return 0<this.ft.length},Li.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Li),Oi=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype._=function(){return!1},Ri.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ri.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ri.prototype.min=function(){return this.left._()?this:this.left.min()},Ri.prototype.it=function(){return this.min().key},Ri.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ri.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ri.prototype.It=function(){if(this.left._())return Ri.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ri.prototype.At=function(){return this.color},Ri.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Ri.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},Ri.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Ri.prototype.Vt=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.Pt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ri.prototype.bt=function(){if(this.At()&&this.left.At())throw Rr();if(this.right.At())throw Rr();var t=this.left.bt();if(t!==this.right.bt())throw Rr();return t+(this.At()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ci(t,e){this.P=t,this.root=e||Oi.EMPTY}function Vi(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.st=!1,Oi.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.nt=function(t,e,n){return new Oi(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype._=function(){return!0},Vi.prototype.ot=function(t){return!1},Vi.prototype.ht=function(t){return!1},Vi.prototype.it=function(){return null},Vi.prototype.rt=function(){return null},Vi.prototype.At=function(){return!1},Vi.prototype.pt=function(){return!0},Vi.prototype.bt=function(){return 0},new Vi);var Mi=(Fi.prototype.has=function(t){return null!==this.data.get(t)},Fi.prototype.first=function(){return this.data.it()},Fi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Fi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fi.prototype.indexOf=function(t){return this.data.indexOf(t)},Fi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Fi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Fi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Fi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Fi.prototype.at=function(){return new Ui(this.data.at())},Fi.prototype.ut=function(t){return new Ui(this.data.ut(t))},Fi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Fi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fi.prototype._=function(){return this.data._()},Fi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fi.prototype.isEqual=function(t){if(!(t instanceof Fi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Fi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fi.prototype.copy=function(t){var e=new Fi(this.P);return e.data=t,e},Fi),Ui=(qi.prototype.dt=function(){return this.Ft.dt().key},qi.prototype.wt=function(){return this.Ft.wt()},qi),ji=new Pi(ii.P);function qi(t){this.Ft=t}function Fi(t){this.P=t,this.data=new Pi(this.P)}var Bi=new Pi(ii.P);var Gi=new Pi(ii.P),zi=new Mi(ii.P);function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ki=new Mi(Mr);function Wi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Qi(t,e){this.targetId=t,this.ee=e}function Xi(t,e,n,r){void 0===n&&(n=Ei.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Yi=(ho.xt=function(t){return new ho(t.P)},ho.prototype.has=function(t){return null!=this.Nt.get(t)},ho.prototype.get=function(t){return this.Nt.get(t)},ho.prototype.first=function(){return this.kt.it()},ho.prototype.last=function(){return this.kt.rt()},ho.prototype._=function(){return this.kt._()},ho.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.kt.nt(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.kt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.P=this.P,n.Nt=t,n.kt=e,n},ho),$i=(ao.prototype.track=function(t){var e=t.doc.key,n=this.$t.get(e);!n||0!==t.type&&3===n.type?this.$t=this.$t.nt(e,t):3===t.type&&1!==n.type?this.$t=this.$t.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.$t=this.$t.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.$t=this.$t.remove(e):1===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):Rr()},ao.prototype.Mt=function(){var n=[];return this.$t.ot(function(t,e){n.push(e)}),n},ao),Ji=(uo.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new uo(t,e,Yi.xt(e),i,n,r,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&Iu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},uo),Zi=(so.Gt=function(t,e){var n=new Map;return n.set(t,to.zt(t,e)),new so(Zr.min(),n,Ki,ji,Hi())},so),to=(oo.zt=function(t,e){return new oo(Ei.Y,e,Hi(),Hi(),Hi())},oo),eo=(Object.defineProperty(io.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),io.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},io.prototype.ce=function(){var n=Hi(),r=Hi(),i=Hi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new to(this.ie,this.re,n,r,i)},io.prototype.le=function(){this.oe=!1,this.se=fo()},io.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},io.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},io.prototype.de=function(){this.ne+=1},io.prototype.we=function(){--this.ne},io.prototype.Te=function(){this.oe=!0,this.re=!0},io),no=(ro.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof ou?this.ge(r,t.te):t.te instanceof su&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},ro.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Rr()}})},ro.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},ro.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(bi(e=o.target)?0===i?(n=new ii(e.path),this.Ve(r,n,new su(n,Zr.min()))):Lr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},ro.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&bi(r.target)&&(n=new ii(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.Ve(e,n,new su(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Hi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Zi(i,s,this.Re,this.me,r);return this.me=ji,this.Ae=co(),this.Re=new Mi(Mr),t},ro.prototype.ge=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.xe(e.key).add(t)))},ro.prototype.Ve=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.xe(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},ro.prototype.removeTarget=function(t){this.Ie.delete(t)},ro.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.$e(t).size+e.Yt.size-e.Xt.size},ro.prototype.de=function(t){this.be(t).de()},ro.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new eo,this.Ie.set(t,e)),e},ro.prototype.xe=function(t){var e=this.Ae.get(t);return e||(e=new Mi(Mr),this.Ae=this.Ae.nt(t,e)),e},ro.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},ro.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},ro.prototype.Se=function(e){var n=this;this.Ie.set(e,new eo),this.Ee.$e(e).forEach(function(t){n.Ve(e,t,null)})},ro.prototype.ke=function(t,e){return this.Ee.$e(t).has(e)},ro);function ro(t){this.Ee=t,this.Ie=new Map,this.me=ji,this.Ae=co(),this.Re=new Mi(Mr)}function io(){this.ne=0,this.se=fo(),this.ie=Ei.Y,this.re=!1,this.oe=!0}function oo(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function so(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function uo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function ao(){this.$t=new Pi(ii.P)}function ho(n){this.P=n?function(t,e){return n(t,e)||ii.P(t.key,e.key)}:function(t,e){return ii.P(t.key,e.key)},this.Nt=Bi,this.kt=new Pi(this.P)}function co(){return new Pi(ii.P)}function fo(){return new Pi(ii.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function po(t){var e=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new Jr(e.seconds,e.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Rr()}function go(r,i){var t,e,n,o=vo(r);if(o!==vo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return po(r).isEqual(po(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),n=Io(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,No(r.bytesValue).isEqual(No(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,To((t=r).geoPointValue.latitude)===To(e.geoPointValue.latitude)&&To(t.geoPointValue.longitude)===To(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return To(t.integerValue)===To(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=To(t.doubleValue),r=To(e.doubleValue);return n===r?di(n)===di(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ur(r.arrayValue.values||[],i.arrayValue.values||[],go);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Gr(t)!==Gr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!go(t[n],e[n])))return!1;return!0}();default:return Rr()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,r,i,o,s,u,a,h,c,f,l=vo(t),p=vo(e);if(l!==p)return Mr(l,p);switch(l){case 0:return 0;case 1:return Mr(t.booleanValue,e.booleanValue);case 2:return h=e,c=To(t.integerValue||t.doubleValue),f=To(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return Mr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=No(o),a=No(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Mr(n[i],r[i]);if(0!==o)return o}return Mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Mr(To(n.latitude),To(r.latitude)))?i:Mr(To(n.longitude),To(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wo(n[i],r[i]);if(o)return o}return Mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Mr(r[s],o[s]);if(0!==u)return u;var a=wo(n[r[s]],i[o[s]]);if(0!==a)return a}return Mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mr(t,e);var n=Io(t),r=Io(e),i=Mr(n.seconds,r.seconds);return 0!==i?i:Mr(n.nanos,r.nanos)}function Eo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Io(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?No(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ii.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e,n}(t)}function Io(t){if(Lr(!!t),"string"!=typeof t)return{seconds:To(t.seconds),nanos:To(t.nanos)};var e,n=0,r=yo.exec(t);Lr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function To(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function No(t){return"string"==typeof t?Ei.fromBase64String(t):Ei.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function _o(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function Do(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var xo={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this.s=t,this.Oe=e};function Lo(t){return{integerValue:""+t}}function Co(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:di(e)?"-0":e}}function Vo(t,e){return yi(e)?Lo(e):Co(t,e)}function Mo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function jo(t){return Lr(!!t),Zr.I((e=Io(t),new Jr(e.seconds,e.nanos)));var e}function qo(t,e){return new ei(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Fo(t){var e=ei.k(t);return Lr(rs(e)),e}function Bo(t,e){return qo(t.s,e.path)}function Go(t,e){var n=Fo(e);return Lr(n.get(1)===t.s.projectId),Lr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ii(Wo(n))}function zo(t,e){return qo(t.s,e)}function Ho(t){var e=Fo(t);return 4===e.length?ei.$():Wo(e)}function Ko(t){return new ei(["projects",t.s.projectId,"databases",t.s.database]).N()}function Wo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Qo(t,e,n){return{name:Bo(t,e),fields:n.proto.mapValue.fields}}function Xo(t,e){var n,r,i,o,s,u;if(e instanceof Vs)n={update:Qo(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Bo(t,e.key)};else if(e instanceof Ms)n={update:Qo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof Bs)n={transform:{document:Bo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof hs)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.N(),increment:e.qe};throw Rr()})}};else{if(!(e instanceof Qs))return Rr();n={verify:Bo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:(s=t,u=o.updateTime,Mo(s,u.A()))}:void 0!==o.exists?{exists:o.exists}:Rr()),n}function Yo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?_s.updateTime(jo(n.updateTime)):void 0!==n.exists?_s.exists(n.exists):_s.We():_s.We();if(t.update){t.update.name;var o=Go(e,t.update.name),s=new Xs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Is(r.map(function(t){return ri.q(t)})));return new Ms(o,s,u,i)}return new Vs(o,s,i)}if(t.delete){var a=Go(e,t.delete);return new Ws(a,i)}if(t.transform){var h=Go(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),i=new as):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new hs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ds(r)):"increment"in e?i=new ms(t,e.increment):Rr();var o=ri.q(e.fieldPath);return new Ts(o,i)}(e,t)});return Lr(!0===i.exists),new Bs(h,c)}if(t.verify){var f=Go(e,t.verify);return new Qs(f,i)}return Rr()}function $o(t,e){return{documents:[zo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:es((e=t).field),direction:(n=e.dir,xo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||pi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,n=t.values||[];return new qu(n,e)}function es(t){return{fieldPath:t.N()}}function ns(t){return ri.q(t.fieldPath)}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function is(){this.Qe=void 0}function os(t,e){return t instanceof ms?_o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var ss,us,as=(n(fs,us=is),fs),hs=(n(cs,ss=is),cs);function cs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ps,ds=(n(ys,ps=is),ys);function ys(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function vs(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!go(t,e)})}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=is),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).serializer=t,n.qe=e,n}function bs(t){return To(t.integerValue||t.doubleValue)}function Es(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Is=(Ns.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Ur(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),Ts=function(t,e){this.field=t,this.transform=e};function Ns(t){(this.fields=t).sort(ri.P)}function As(t,e){this.version=t,this.transformResults=e}var _s=(Ss.We=function(){return new Ss},Ss.exists=function(t){return new Ss(void 0,t)},Ss.updateTime=function(t){return new Ss(t)},Object.defineProperty(Ss.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ss.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ss);function Ss(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof ou&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ou}function Ds(){}function Ps(t,e,n){return t instanceof Vs?new ou(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ms?function(t,e,n){if(!ks(t.Ue,e))return new uu(t.key,n.version);var r=qs(t,e);return new ou(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Bs?function(t,e,n){if(Lr(null!=n.transformResults),!ks(t.Ue,e))return new uu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof ou&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof hs?ls(i,o):i instanceof ds?vs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=zs(t,r.data(),i);return new ou(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new su(t.key,n.version,{hasCommittedMutations:!0})}function xs(t,e,n,r){return t instanceof Vs?function(t,e){if(!ks(t.Ue,e))return e;var n=Rs(e);return new ou(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Ms?function(t,e){if(!ks(t.Ue,e))return e;var n=Rs(e),r=qs(t,e);return new ou(t.key,n,r,{Ke:!0})}(t,e):t instanceof Bs?function(t,e,n,r){if(!ks(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c,f=[],l=0,p=t;l<p.length;l++){var d=p[l],y=d.transform,v=null;n instanceof ou&&(v=n.field(d.field)),null===v&&r instanceof ou&&(v=r.field(d.field)),f.push((o=v,s=e,c=h=a=u=void 0,(i=y)instanceof as?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof hs?ls(i,o):i instanceof ds?vs(i,o):(a=os(u=i,o),h=bs(a)+bs(u.qe),_o(a)&&_o(u.qe)?Lo(h):Co(u.serializer,h))))}return f}(t.fieldTransforms,n,e,r),s=zs(t,i.data(),o);return new ou(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,ks((i=t).Ue,o)?new su(i.key,Zr.min()):o);var i,o}function Os(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Ur(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof hs&&o instanceof hs||i instanceof ds&&o instanceof ds?Ur(i.elements,o.elements,go):i instanceof ms&&o instanceof ms?go(i.qe,o.qe):i instanceof as&&o instanceof as);var n,r,i,o}))}function Rs(t){return t instanceof ou?t.version:Zr.min()}var Ls,Cs,Vs=(n(js,Cs=Ds),js),Ms=(n(Us,Ls=Ds),Us);function Us(t,e,n,r){var i=this;return(i=Ls.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Cs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function qs(t,e){return n=t,r=e instanceof ou?e.data():Xs.empty(),i=new Ys(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var Fs,Bs=(n(Gs,Fs=Ds),Gs);function Gs(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=_s.exists(!0),n}function zs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Hs,Ks,Ws=(n(tu,Ks=Ds),tu),Qs=(n(Zs,Hs=Ds),Zs),Xs=(Js.empty=function(){return new Js({mapValue:{}})},Js.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Js.prototype.isEqual=function(t){return go(this.proto,t.proto)},Js),Ys=($s.prototype.set=function(t,e){return this.Ye(t,e),this},$s.prototype.delete=function(t){return this.Ye(t,null),this},$s.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},$s.prototype.Ge=function(){var t=this.Je(ri.$(),this.He);return null!=t?new Xs(t):this.ze},$s.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},$s);function $s(t){void 0===t&&(t=Xs.empty()),this.ze=t,this.He=new Map}function Js(t){this.proto=t}function Zs(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function tu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ue=e,n.type=3,n}function eu(t,e){this.key=t,this.version=e}var nu,ru,iu,ou=(n(cu,iu=eu),cu.prototype.field=function(t){return this.Xe.field(t)},cu.prototype.data=function(){return this.Xe},cu.prototype.Ze=function(){return this.Xe.proto},cu.prototype.isEqual=function(t){return t instanceof cu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},cu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu),su=(n(hu,ru=eu),hu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),uu=(n(au,nu=eu),au.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),au.prototype.isEqual=function(t){return t instanceof au&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},au);function au(){return null!==nu&&nu.apply(this,arguments)||this}function hu(t,e,n){var r=this;return(r=ru.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function cu(t,e,n,r){var i=this;return(i=iu.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $r(Yr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $r(Yr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var lu=(pu.prototype.rn=function(t){return new pu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},pu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},pu.prototype.hn=function(){return!pi(this.limit)&&"F"===this.en},pu.prototype.an=function(){return!pi(this.limit)&&"L"===this.en},pu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},pu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},pu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},pu);function pu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function du(t,e,n,r,i,o,s,u){return new lu(t,e,n,r,i,o,s,u)}function yu(t){return new lu(t)}function vu(t){return null!==t.collectionGroup}function gu(t){var e=fu(t,lu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Xu(n)),e.nn.push(new Xu(ri.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Xu(ri.L(),i)))}}return e.nn}function mu(t){var e=fu(t,lu);if(!e.sn)if("F"===e.en)e.sn=gi(e.path,e.collectionGroup,gu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=gu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Xu(o.field,s))}var u=e.endAt?new qu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new qu(e.startAt.position,!e.startAt.before):null;e.sn=gi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function wu(t,e,n){return new lu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bu(t,e){return new lu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function Eu(t,e){return new lu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function Iu(t,e){return wi(mu(t),mu(e))&&t.en===e.en}function Tu(t){return mi(mu(t))+"|lt:"+t.en}function Nu(t){return"Query(target="+(e=mu(t),n=e.path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+Eo(e.value);var e}).join(", ")+"]"),pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ku(e.startAt)),e.endAt&&(n+=", endAt: "+Ku(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Au(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ii.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Wu(e.startAt,gu(e),n))&&(!e.endAt||!Wu(e.endAt,gu(e),n)));var e,n,r,o}function _u(u){return function(t,e){for(var n=!1,r=0,i=gu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.O()?ii.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?wo(n,r):Rr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Su,ku=(n(Du,Su=function(){}),Du.create=function(t,e,n){if(t.O())return"in"===e?new Vu(t,n):new Cu(t,e,n);if(ko(n)){if("=="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Du(t,e,n)}if(Do(n)){if("=="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Du(t,e,n)}return"array-contains"===e?new Mu(t,n):"in"===e?new Uu(t,n):"array-contains-any"===e?new ju(t,n):new Du(t,e,n)},Du.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&vo(this.value)===vo(e)&&this.fn(wo(e,this.value))},Du.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},Du.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Du);function Du(t,e,n){var r=this;return(r=Su.call(this)||this).field=t,r.op=e,r.value=n,r}var Pu,xu,Ou,Ru,Lu,Cu=(n(Hu,Lu=ku),Hu.prototype.matches=function(t){var e=ii.P(t.key,this.key);return this.fn(e)},Hu),Vu=(n(zu,Ru=ku),zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},zu),Mu=(n(Gu,Ou=ku),Gu.prototype.matches=function(t){var e=t.field(this.field);return So(e)&&mo(e.arrayValue,this.value)},Gu),Uu=(n(Bu,xu=ku),Bu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&mo(this.value.arrayValue,e)},Bu),ju=(n(Fu,Pu=ku),Fu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!So(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Fu),qu=function(t,e){this.position=t,this.before=e};function Fu(t,e){return Pu.call(this,t,"array-contains-any",e)||this}function Bu(t,e){return xu.call(this,t,"in",e)||this}function Gu(t,e){return Ou.call(this,t,"array-contains",e)||this}function zu(t,e){var n=this;return(n=Ru.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ii.B(t.referenceValue)}),n}function Hu(t,e,n){var r=this;return(r=Lu.call(this,t,e,n)||this).key=ii.B(n.referenceValue),r}function Ku(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function Wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?ii.P(ii.B(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var Xu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Yu=(la.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ps(o,e,r[i]))}return e},la.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=xs(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=xs(a,e,o,this.dn))}return e},la.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},la.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Hi())},la.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ur(this.mutations,t.mutations,Os)&&Ur(this.baseMutations,t.baseMutations,Os)},la),$u=(fa.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new fa(t,e,n,r)},fa),Ju=(ca.prototype.catch=function(t){return this.next(void 0,t)},ca.prototype.next=function(r,i){var o=this;return this.Vn&&Rr(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new ca(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},ca.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ca.prototype.vn=function(t){try{var e=t();return e instanceof ca?e:ca.resolve(e)}catch(t){return ca.reject(t)}},ca.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):ca.resolve(e)},ca.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):ca.reject(e)},ca.resolve=function(n){return new ca(function(t,e){t(n)})},ca.reject=function(n){return new ca(function(t,e){e(n)})},ca.Sn=function(t){return new ca(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ca.Dn=function(t){for(var n=ca.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ca.resolve(t):e()})}(r[e]);return n},ca.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},ca),Zu=(Object.defineProperty(ha.prototype,"readTime",{get:function(){return this.Nn},set:function(t){this.Nn=t},enumerable:!1,configurable:!0}),ha.prototype.kn=function(t,e){this.xn(),this.readTime=e,this.Cn.set(t.key,t)},ha.prototype.$n=function(t,e){this.xn(),e&&(this.readTime=e),this.Cn.set(t,null)},ha.prototype.Mn=function(t,e){this.xn();var n=this.Cn.get(e);return void 0!==n?Ju.resolve(n):this.On(t,e)},ha.prototype.getEntries=function(t,e){return this.Ln(t,e)},ha.prototype.apply=function(t){return this.xn(),this.Fn=!0,this.qn(t)},ha.prototype.xn=function(){},ha),ta="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ea=(aa.prototype.Un=function(t){this.Bn.push(t)},aa.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},aa),na=(ua.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},ua.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},ua.prototype.Yn=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},ua.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},ua.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=ji;return e.forEach(function(t,e){e=e||new su(t,Zr.min()),n=n.nt(t,e)}),n})},ua.prototype.ts=function(t,e,n){return r=e,ii.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):vu(e)?this.ns(t,e,n):this.ss(t,e,n);var r},ua.prototype.es=function(t,e){return this.Gn(t,new ii(e)).next(function(t){var e=Bi;return t instanceof ou&&(e=e.nt(t.key,t)),e})},ua.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi;return this.Kn.rs(n,s).next(function(t){return Ju.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},ua.prototype.ss=function(e,n,t){var c,f,r=this;return this.Qn.ts(e,n,t).next(function(t){return c=t,r.jn.os(e,n)}).next(function(t){return f=t,r.hs(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=xs(s,a,a,r.dn);c=h instanceof ou?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Au(n,e)||(c=c.remove(t))}),c})},ua.prototype.hs=function(t,e,n){for(var r=Hi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ou&&(h=h.nt(t,e))}),h})},ua),ra=(sa.cs=function(t,e){for(var n=Hi(),r=Hi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new sa(t,e.fromCache,n,r)},sa),ia=(oa.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},oa.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},oa);function oa(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function sa(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function ua(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function aa(){this.Bn=[]}function ha(){this.Cn=new Xr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function ca(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function fa(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function la(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}ia.ws=-1;function pa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var da=(ya.prototype.reset=function(){this.Rs=0},ya.prototype.Vs=function(){this.Rs=this.As},ya.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},ya.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},ya.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},ya.prototype.ps=function(){return(Math.random()-.5)*this.Rs},ya);function ya(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function va(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ga(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return ga(e)}function ga(t){return t+""}function ma(t){var e=t.length;if(Lr(2<=e),2===e)return Lr(""===t.charAt(0)&&""===t.charAt(1)),ei.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Rr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Rr()}o=s+2}return new ei(r)}var wa=(Na.prototype.Cs=function(t,e){return this.Ds.add(e),Ju.resolve()},Na.prototype.rs=function(t,e){return Ju.resolve(this.Ds.getEntries(e))},Na),ba=(Ta.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Mi(ei.P),i=!r.has(n);return this.index[e]=r.add(n),i},Ta.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Ta.prototype.getEntries=function(t){return(this.index[t]||new Mi(ei.P)).F()},Ta),Ea=(Ia.prototype.Cs=function(t,e){var n=this;if(this.Fs.has(e))return Ju.resolve();var r=e.S(),i=e.p();t.Un(function(){n.Fs.add(e)});var o={collectionId:r,parent:va(i)};return Aa(t).put(o)},Ia.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[jr(i),""],!1,!0);return Aa(t).Ns(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ma(r.parent))}return o})},Ia);function Ia(){this.Fs=new ba}function Ta(){this.index={}}function Na(){this.Ds=new ba}function Aa(t){return th.ks(t,Oh.store)}var _a=function(t){this.xs=t};function Sa(t,e){if(e.document)return n=t.xs,r=e.document,i=!!e.hasCommittedMutations,o=Go(n,r.name),s=jo(r.updateTime),u=new Xs({mapValue:{fields:r.fields}}),new ou(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ii.j(e.noDocument.path),h=Oa(e.noDocument.readTime);return new su(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ii.j(e.unknownDocument.path),f=Oa(e.unknownDocument.version);return new uu(c,f)}return Rr()}function ka(t,e,n){var r,i,o=Da(n),s=e.key.path.p().F();if(e instanceof ou){var u={name:Bo(r=t.xs,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Mo(r,i.version.A())},a=e.hasCommittedMutations;return new Sh(null,null,u,a,o,s)}if(e instanceof su){var h=e.key.path.F(),c=xa(e.version),f=e.hasCommittedMutations;return new Sh(null,new Ah(h,c),null,f,o,s)}if(e instanceof uu){var l=e.key.path.F(),p=xa(e.version);return new Sh(new _h(l,p),null,null,!0,o,s)}return Rr()}function Da(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Pa(t){var e=new Jr(t[0],t[1]);return Zr.I(e)}function xa(t){var e=t.A();return new mh(e.seconds,e.nanoseconds)}function Oa(t){var e=new Jr(t.seconds,t.nanoseconds);return Zr.I(e)}function Ra(e,t){var n=(t.baseMutations||[]).map(function(t){return Yo(e.xs,t)}),r=t.mutations.map(function(t){return Yo(e.xs,t)}),i=Jr.fromMillis(t.localWriteTimeMs);return new Yu(t.batchId,i,n,r)}function La(t){var e,n=Oa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Oa(t.lastLimboFreeSnapshotVersion):Zr.min(),i=void 0!==t.query.documents?(Lr(1===(e=t.query).documents.length),mu(yu(Ho(e.documents[0])))):function(t){var e,n=Ho(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Lr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return ku.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,ku.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Xu(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(a=r.limit,c=pi(h="object"==typeof a?a.value:a)?null:h);var f=null;r.startAt&&(f=ts(r.startAt));var l=null;return r.endAt&&(l=ts(r.endAt)),mu(du(n,o,u,s,c,"F",f,l))}(t.query);return new _i(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ei.fromBase64String(t.resumeToken))}function Ca(t,e){var n=xa(e.X),r=xa(e.lastLimboFreeSnapshotVersion),i=(bi(e.target)?$o:Jo)(t.xs,e.target),o=e.resumeToken.toBase64();return new Dh(e.targetId,mi(e.target),n,o,e.sequenceNumber,r,i)}var Va,Ma=(Ua.prototype.kn=function(t,e,n){return qa(t).put(Fa(e),n)},Ua.prototype.$n=function(t,e){var n=qa(t),r=Fa(e);return n.delete(r)},Ua.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$s(e,t)})},Ua.prototype.Mn=function(t,e){var n=this;return qa(t).get(Fa(e)).next(function(t){return n.Ms(t)})},Ua.prototype.Os=function(t,e){var n=this;return qa(t).get(Fa(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:Ba(t)}:null})},Ua.prototype.getEntries=function(t,e){var r=this,i=ji;return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},Ua.prototype.Bs=function(t,e){var r=this,i=ji,o=new Pi(ii.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,Ba(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},Ua.prototype.qs=function(t,e,i){if(e._())return Ju.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return qa(t).Qs({range:n},function(t,e,n){for(var r=ii.j(t);s&&ii.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Ua.prototype.ts=function(t,i,e){var n,r,o,s=this,u=Bi,a=i.path.length+1,h={};return e.isEqual(Zr.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=Da(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Sh.collectionReadTimeIndex),qa(t).Qs(h,function(t,e,n){var r;t.length===a&&(r=Sa(s.serializer,e),i.path.D(r.key.path)?r instanceof ou&&Au(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Ua.prototype.Ks=function(t,e){var r=this,i=ji,o=Da(e),n=qa(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:Sh.readTimeIndex,range:s},function(t,e){var n=Sa(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:Pa(o)}})},Ua.prototype.zs=function(t){var e=qa(t),r=Zr.min();return e.Qs({index:Sh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Pa(e.readTime)),n.done()}).next(function(){return r})},Ua.prototype.Hs=function(t){return new Ua.Ys(this,!!t&&t.Js)},Ua.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ua.prototype.getMetadata=function(t){return ja(t).get(kh.key).next(function(t){return Lr(!!t),t})},Ua.prototype.$s=function(t,e){return ja(t).put(kh.key,e)},Ua.prototype.Ms=function(t){if(t){var e=Sa(this.serializer,t);return e instanceof su&&e.version.isEqual(Zr.min())?null:e}return null},Ua);function Ua(t,e){this.serializer=t,this.Kn=e}function ja(t){return th.ks(t,kh.store)}function qa(t){return th.ks(t,Sh.store)}function Fa(t){return t.path.F()}function Ba(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}function Ga(t,e){var n=this;return(n=Va.call(this)||this).Zs=t,n.Js=e,n.ti=new Xr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ma.Ys=(n(Ga,Va=Zu),Ga.prototype.qn=function(s){var u=this,a=[],h=0,c=new Mi(function(t,e){return Mr(t.N(),e.N())});return this.Cn.forEach(function(t,e){var n,r,i,o=u.ti.get(t);e?(n=ka(u.Zs.serializer,e,u.readTime),c=c.add(t.path.p()),r=Ba(n),h+=r-o,a.push(u.Zs.kn(s,t,n))):(h-=o,u.Js?(i=ka(u.Zs.serializer,new su(t,Zr.min()),u.readTime),a.push(u.Zs.kn(s,t,i))):a.push(u.Zs.$n(s,t)))}),c.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,h)),Ju.Sn(a)},Ga.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},Ga.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},Ga);var za=(Wa.prototype.next=function(){return this.ei+=2,this.ei},Wa.ni=function(){return new Wa(0)},Wa.si=function(){return new Wa(-1)},Wa),Ha=(Ka.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new za(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},Ka.prototype.ai=function(t){return this.oi(t).next(function(t){return Zr.I(new Jr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ka.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},Ka.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},Ka.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},Ka.prototype.di=function(t,e){return this._i(t,e)},Ka.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Qa(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.hi(e,t)})},Ka.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Qa(r).Qs(function(t,e){var n=La(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return Ju.Sn(a)}).next(function(){return u})},Ka.prototype.pe=function(t,r){return Qa(t).Qs(function(t,e){var n=La(e);r(n)})},Ka.prototype.oi=function(t){return Xa(t).get(xh.key).next(function(t){return Lr(null!==t),t})},Ka.prototype.hi=function(t,e){return Xa(t).put(xh.key,e)},Ka.prototype._i=function(t,e){return Qa(t).put(Ca(this.serializer,e))},Ka.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ka.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},Ka.prototype.mi=function(t,i){var e=mi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Qa(t).Qs({range:n,index:Dh.queryTargetsIndexName},function(t,e,n){var r=La(e);wi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},Ka.prototype.Ai=function(n,t,r){var i=this,o=[],s=Ya(n);return t.forEach(function(t){var e=va(t.path);o.push(s.put(new Ph(r,e))),o.push(i.ii.Ri(n,r,t))}),Ju.Sn(o)},Ka.prototype.Pi=function(n,t,r){var i=this,o=Ya(n);return Ju.forEach(t,function(t){var e=va(t.path);return Ju.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},Ka.prototype.Ti=function(t,e){var n=Ya(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Ka.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ya(t),o=Hi();return r.Qs({range:n,yi:!0},function(t,e,n){var r=ma(t[1]),i=new ii(r);o=o.add(i)}).next(function(){return o})},Ka.prototype.pi=function(t,e){var n=va(e.path),r=IDBKeyRange.bound([n],[jr(n)],!1,!0),i=0;return Ya(t).Qs({index:Ph.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ka.prototype.Me=function(t,e){return Qa(t).get(e).next(function(t){return t?La(t):null})},Ka);function Ka(t,e){this.ii=t,this.serializer=e}function Wa(t){this.ei=t}function Qa(t){return th.ks(t,Dh.store)}function Xa(t){return th.ks(t,xh.store)}function Ya(t){return th.ks(t,Ph.store)}var $a,Ja="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Za=(n(nh,$a=ea),nh),th=(eh.ks=function(t,e){if(t instanceof Za)return Mh.ks(t.bi,e);throw Rr()},eh.prototype.start=function(){var e=this;return Mh.Ui(this.Li,vh,new gh(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new $r(Yr.FAILED_PRECONDITION,Ja);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new ia(t,e.Si)}).then(function(){e.Fi=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},eh.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},eh.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},eh.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},eh.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ih(e).put(new Lh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(Gh(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},eh.prototype.tr=function(t){var e=this;return rh(t).get(wh.key).next(function(t){return Ju.resolve(e.rr(t))})},eh.prototype.or=function(t){return ih(t).delete(this.clientId)},eh.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.$i,18e5)?[3,2]:(this.$i=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=eh.ks(t,Lh.store);return r.Ns().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ju.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},eh.prototype.Gi=function(){var t=this;this.xi=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},eh.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},eh.prototype.nr=function(e){var i=this;return this.Di?Ju.resolve(!0):rh(e).get(wh.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new $r(Yr.FAILED_PRECONDITION,Ja);return!1}}return!(!i.networkEnabled||!i.inForeground)||ih(e).Ns().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},eh.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Fi=!1,this.dr(),this.xi&&(this.xi.cancel(),this.xi=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){Dr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},eh.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},eh.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return ih(t).Ns().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(eh.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),eh.prototype.mr=function(t){return hh.Ar(t,this.serializer,this.Kn,this.ii)},eh.prototype.Rr=function(){return this.qi},eh.prototype.Pr=function(){return this.Qn},eh.prototype.gr=function(){return this.Kn},eh.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Vh,function(t){return o=new Za(t,i.Ci?i.Ci.next():ia.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw Pr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new $r(Yr.FAILED_PRECONDITION,ta);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},eh.prototype.Vr=function(t){var e=this;return rh(t).get(wh.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new $r(Yr.FAILED_PRECONDITION,Ja)})},eh.prototype.ir=function(t){var e=new wh(this.clientId,this.allowTabSynchronization,Date.now());return rh(t).put(wh.key,e)},eh.Oi=function(){return Mh.Oi()},eh.prototype.sr=function(t){var e=this,n=rh(t);return n.get(wh.key).next(function(t){return e.rr(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(wh.key)):Ju.resolve()})},eh.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Pr("Detected an update time that is in the future: "+t+" > "+n),1))},eh.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)},eh.prototype.wr=function(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)},eh.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ni=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.Ni))},eh.prototype.Tr=function(){this.Ni&&(this.window.removeEventListener("unload",this.Ni),this.Ni=null)},eh.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Pr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},eh.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){Pr("Failed to set zombie client id.",t)}},eh.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},eh.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},eh);function eh(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=h,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.ki=null,this.xi=null,this.$i=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!eh.Oi())throw new $r(Yr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new oh(this,r),this.Li=e+"main",this.serializer=new _a(u),this.qi=new Ha(this.ii,this.serializer),this.Kn=new Ea,this.Qn=new Ma(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&Pr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function nh(t,e){var n=this;return(n=$a.call(this)||this).bi=t,n.vi=e,n}function rh(t){return th.ks(t,wh.store)}function ih(t){return th.ks(t,Lh.store)}var oh=(sh.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},sh.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},sh.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},sh.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},sh.prototype.Ri=function(t,e,n){return uh(t,n)},sh.prototype.gi=function(t,e,n){return uh(t,n)},sh.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},sh.prototype.Dr=uh,sh.prototype.Cr=function(t,e){return r=e,i=!1,yh(n=t).Fr(function(t){return fh(n,t,r).next(function(t){return t&&(i=!0),Ju.resolve(!t)})}).next(function(){return i});var n,r,i},sh.prototype.Nr=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){var n;t<=i&&(n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.$n(e),Ya(r).delete([0,va(e.path)])})}),u.push(n))}).next(function(){return Ju.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},sh.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},sh.prototype.kr=uh,sh.prototype.Sr=function(t,o){var s,e=Ya(t),u=ia.ws;return e.Qs({index:Ph.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==ia.ws&&o(new ii(ma(s)),u),u=i,s=r):u=ia.ws}).next(function(){u!==ia.ws&&o(new ii(ma(s)),u)})},sh.prototype.xr=function(t){return this.db.Pr().Xs(t)},sh);function sh(t,e){this.db=t,this.yr=new cc(this,e)}function uh(t,e){return Ya(t).put((n=t.vi,new Ph(0,va(e.path),n)));var n}function ah(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var hh=(ch.Ar=function(t,e,n,r){return Lr(""!==t.uid),new ch(t.Mr()?t.uid:"",e,n,r)},ch.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ph(t).Qs({index:Ih.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ch.prototype.Lr=function(d,y,v,g){var m=this,w=dh(d),b=ph(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new Yu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Xo(e.xs,t)}),o=r.mutations.map(function(t){return Xo(e.xs,t)}),new Ih(n,r.batchId,r.dn.toMillis(),i,o)),a=[],h=new Mi(function(t,e){return Mr(t.N(),e.N())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Th.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Th.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Kn.Cs(d,t))}),d.Un(function(){m.$r[t]=s.keys()}),Ju.Sn(a).next(function(){return s})})},ch.prototype.qr=function(t,e){var n=this;return ph(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),Ra(n.serializer,t)):null})},ch.prototype.Br=function(t,n){var r=this;return this.$r[n]?Ju.resolve(this.$r[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.$r[n]=e}return null})},ch.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return ph(t).Qs({index:Ih.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=Ra(r.serializer,e)),n.done()}).next(function(){return o})},ch.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ph(t).Qs({index:Ih.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ch.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ph(t).Ns(Ih.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ra(e.serializer,t)})})},ch.prototype.zn=function(u,a){var h=this,t=Th.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return dh(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ma(i);if(r===h.userId&&a.path.isEqual(s))return ph(u).get(o).next(function(t){if(!t)throw Rr();Lr(t.userId===h.userId),c.push(Ra(h.serializer,t))});n.done()}).next(function(){return c})},ch.prototype.Zn=function(r,t){var a=this,h=new Mi(Mr),i=[];return t.forEach(function(u){var t=Th.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=dh(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ma(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Ju.Sn(i).next(function(){return a.jr(r,h)})},ch.prototype.os=function(t,e){var u=this,a=e.path,h=a.length+1,n=Th.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Mi(Mr);return dh(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ma(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.jr(t,c)})},ch.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(ph(e).get(t).next(function(t){if(null===t)throw Rr();Lr(t.userId===n.userId),r.push(Ra(n.serializer,t))}))}),Ju.Sn(i).next(function(){return r})},ch.prototype.Kr=function(e,n){var r=this;return lh(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),Ju.forEach(t,function(t){return r.ii.Dr(e,t)})})},ch.prototype.Gr=function(t){delete this.$r[t]},ch.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return Ju.resolve();var e=IDBKeyRange.lowerBound(Th.prefixForUser(o.userId)),i=[];return dh(n).Qs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=ma(t[1]),i.push(r)):n.done()}).next(function(){Lr(0===i.length)})})},ch.prototype.pi=function(t,e){return fh(t,this.userId,e)},ch.prototype.Hr=function(t){var e=this;return yh(t).get(this.userId).next(function(t){return t||new Eh(e.userId,-1,"")})},ch);function ch(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.$r={}}function fh(t,o,e){var n=Th.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return dh(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function lh(t,e,n){var r=t.store(Ih.store),i=t.store(Th.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Lr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Th.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Ju.Sn(o).next(function(){return h})}function ph(t){return th.ks(t,Ih.store)}function dh(t){return th.ks(t,Th.store)}function yh(t){return th.ks(t,Eh.store)}var vh=10,gh=(bh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Lr(t<e&&0<=t&&e<=vh);var o,s=new zh(r);t<1&&1<=e&&(n.createObjectStore(wh.store),(o=n).createObjectStore(Eh.store,{keyPath:Eh.keyPath}),o.createObjectStore(Ih.store,{keyPath:Ih.keyPath,autoIncrement:!0}).createIndex(Ih.userMutationsIndex,Ih.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Th.store),Rh(n),n.createObjectStore(Sh.store));var u,a=Ju.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Ph.store),u.deleteObjectStore(Dh.store),u.deleteObjectStore(xh.store),Rh(n)),a=a.next(function(){return t=s.store(xh.store),e=new xh(0,0,Zr.min().A(),0),t.put(xh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Ih.store).Ns().next(function(t){r.deleteObjectStore(Ih.store),r.createObjectStore(Ih.store,{keyPath:Ih.keyPath,autoIncrement:!0}).createIndex(Ih.userMutationsIndex,Ih.userMutationsKeyPath,{unique:!0});var e=i.store(Ih.store),n=t.map(function(t){return e.put(t)});return Ju.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Lh.store,{keyPath:Lh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(kh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Sh.store)).createIndex(Sh.readTimeIndex,Sh.readTimeIndexPath,{unique:!1}),t.createIndex(Sh.collectionReadTimeIndex,Sh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},bh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Sh.store).Qs(function(t,e){n+=Ba(e)}).next(function(){var t=new kh(n);return e.store(kh.store).put(kh.key,t)})},bh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Eh.store),e=r.store(Ih.store);return t.Ns().next(function(t){return Ju.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ns(Ih.userMutationsIndex,t).next(function(t){return Ju.forEach(t,function(t){Lr(t.userId===n.userId);var e=Ra(i.serializer,t);return lh(r,n.userId,e).next(function(){})})})})})},bh.prototype.ensureSequenceNumbers=function(t){var s=t.store(Ph.store),e=t.store(Sh.store);return t.store(xh.store).get(xh.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new ei(t),r=[0,va(n)];o.push(s.get(r).next(function(t){return t?Ju.resolve():s.put(new Ph(0,va(n),i.highestListenSequenceNumber))}))}).next(function(){return Ju.Sn(o)})})},bh.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:va(n)})}}t.createObjectStore(Oh.store,{keyPath:Oh.keyPath});var r=e.store(Oh.store),o=new ba;return e.store(Sh.store).Qs({yi:!0},function(t,e){var n=new ei(t);return i(n.p())}).next(function(){return e.store(Th.store).Qs({yi:!0},function(t,e){t[0];var n=t[1],r=(t[2],ma(n));return i(r.p())})})},bh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Dh.store);return o.Qs(function(t,e){var n=La(e),r=Ca(i.serializer,n);return o.put(r)})},bh),mh=function(t,e){this.seconds=t,this.nanoseconds=e},wh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function bh(t){this.serializer=t}wh.store="owner",wh.key="owner";var Eh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Eh.store="mutationQueues",Eh.keyPath="userId";var Ih=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ih.store="mutations",Ih.keyPath="batchId",Ih.userMutationsIndex="userMutationsIndex",Ih.userMutationsKeyPath=["userId","batchId"];var Th=(Nh.prefixForUser=function(t){return[t]},Nh.prefixForPath=function(t,e){return[t,va(e)]},Nh.key=function(t,e,n){return[t,va(e),n]},Nh);function Nh(){}Th.store="documentMutations",Th.PLACEHOLDER=new Th;var Ah=function(t,e){this.path=t,this.readTime=e},_h=function(t,e){this.path=t,this.version=e},Sh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Sh.store="remoteDocuments",Sh.readTimeIndex="readTimeIndex",Sh.readTimeIndexPath="readTime",Sh.collectionReadTimeIndex="collectionReadTimeIndex",Sh.collectionReadTimeIndexPath=["parentPath","readTime"];var kh=function(t){this.byteSize=t};kh.store="remoteDocumentGlobal",kh.key="remoteDocumentGlobalKey";var Dh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Dh.store="targets",Dh.keyPath="targetId",Dh.queryTargetsIndexName="queryTargetsIndex",Dh.queryTargetsKeyPath=["canonicalId","targetId"];var Ph=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ph.store="targetDocuments",Ph.keyPath=["targetId","path"],Ph.documentTargetsIndex="documentTargetsIndex",Ph.documentTargetsKeyPath=["path","targetId"];var xh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};xh.key="targetGlobalKey",xh.store="targetGlobal";var Oh=function(t,e){this.collectionId=t,this.parent=e};function Rh(t){t.createObjectStore(Ph.store,{keyPath:Ph.keyPath}).createIndex(Ph.documentTargetsIndex,Ph.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Dh.store,{keyPath:Dh.keyPath}).createIndex(Dh.queryTargetsIndexName,Dh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(xh.store)}Oh.store="collectionParents",Oh.keyPath=["collectionId","parent"];var Lh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Lh.store="clientMetadata",Lh.keyPath="clientId";var Ch,Vh=i(i(i([Eh.store,Ih.store,Th.store,Sh.store,Dh.store,wh.store,xh.store,Ph.store],[Lh.store]),[kh.store]),[Oh.store]),Mh=(Bh.Ui=function(o,t,s){return Dr("SimpleDb","Opening database:",o),new Ju(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Bh(e))},i.onblocked=function(){r(new $r(Yr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new $r(Yr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,vh).next(function(){Dr("SimpleDb","Database upgrade to version "+vh+" complete")})}}).bn()},Bh.delete=function(t){return Dr("SimpleDb","Removing database:",t),Qh(window.indexedDB.deleteDatabase(t)).bn()},Bh.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(Bh.Jr())return!0;var t=p(),e=Bh.Yr(t),n=0<e&&e<10,r=Bh.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Bh.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},Bh.ks=function(t,e){return t.store(e)},Bh.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Bh.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Bh.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},Bh.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=zh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Ju.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Dr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Bh.prototype.close=function(){this.db.close()},Bh),Uh=(Object.defineProperty(Fh.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(Fh.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(Fh.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Fh.prototype.done=function(){this.no=!0},Fh.prototype.js=function(t){this.so=t},Fh.prototype.delete=function(){return Qh(this.eo.delete())},Fh),jh=(n(qh,Ch=$r),qh);function qh(t){var e=this;return(e=Ch.call(this,Yr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Fh(t){this.eo=t,this.no=!1,this.so=null}function Bh(t){this.db=t,12.2===Bh.Yr(p())&&Pr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Gh(t){return"IndexedDbTransactionError"===t.name}var zh=(Wh.open=function(t,e,n){return new Wh(t.transaction(n,e))},Object.defineProperty(Wh.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Wh.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Wh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Hh(e)},Wh),Hh=(Kh.prototype.put=function(t,e){var n=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Qh(n)},Kh.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Qh(this.store.add(t))},Kh.prototype.get=function(e){var n=this;return Qh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},Kh.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Qh(this.store.delete(t))},Kh.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Qh(this.store.count())},Kh.prototype.Ns=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},Kh.prototype.ho=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},Kh.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},Kh.prototype.Fr=function(i){var t=this.cursor({});return new Ju(function(n,r){t.onerror=function(t){var e=Yh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Kh.prototype.oo=function(t,s){var u=[];return new Ju(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Uh(i),(n=s(i.primaryKey,i.value,e))instanceof Ju&&(r=n.catch(function(t){return e.done(),Ju.reject(t)}),u.push(r)),e.gn?o():null===e.io?i.continue():i.continue(e.io)):o()}}).next(function(){return Ju.Sn(u)})},Kh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Kh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Kh);function Kh(t){this.store=t}function Wh(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new pa,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new jh(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=Yh(t.target.error);n.ro.reject(new jh(e))}}function Qh(t){return new Ju(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Yh(t.target.error);r(e)}})}var Xh=!1;function Yh(t){var e=Mh.Yr(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new $r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xh||(Xh=!0,setTimeout(function(){throw r},0)),r}}return t}function $h(){return"undefined"!=typeof window?window:null}var Jh=(ec._o=function(t,e,n,r,i){var o=new ec(t,e,Date.now()+n,r,i);return o.start(n),o},ec.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},ec.prototype.Ss=function(){return this.do()},ec.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new $r(Yr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ec.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},ec.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},ec),Zh=(Object.defineProperty(tc.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),tc.prototype.Zi=function(t){this.enqueue(t)},tc.prototype.po=function(t){this.bo(),this.vo(t)},tc.prototype.So=function(t){return this.bo(),this.vo(t)},tc.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=$h())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},tc.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},tc.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},tc.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!Gh(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},tc.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},tc.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=Jh._o(this,t,e,n,function(t){return r.Fo(t)});return this.Io.push(i),i},tc.prototype.bo=function(){this.mo&&Rr()},tc.prototype.No=function(){},tc.prototype.ko=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},tc.prototype.xo=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},tc.prototype.$o=function(r){var i=this;return this.ko().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.ko()})},tc.prototype.Mo=function(t){this.Ro.push(t)},tc.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},tc);function tc(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new da(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=$h();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function ec(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new pa,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function nc(t,e){if(Pr("AsyncQueue",e+": "+t),Gh(t))return new $r(Yr.UNAVAILABLE,e+": "+t);throw t}function rc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Mr(n,i);return 0===s?Mr(r,o):s}var ic=(ac.prototype.qo=function(){return++this.Lo},ac.prototype.Bo=function(t){var e,n=[t,this.qo()];this.buffer.size<this.Oo?this.buffer=this.buffer.add(n):rc(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(ac.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),ac),oc={Uo:!1,Wo:0,Qo:0,jo:0},sc=(uc.Ho=function(t){return new uc(t,uc.Yo,uc.Jo)},uc);function uc(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function ac(t){this.Oo=t,this.buffer=new Mi(rc),this.Lo=0}sc.Xo=-1,sc.Zo=1048576,sc.th=41943040,sc.Yo=10,sc.Jo=1e3,sc.eh=new sc(sc.th,sc.Yo,sc.Jo),sc.nh=new sc(sc.Xo,0,0);var hc=(dc.prototype.start=function(t){this.yr.params.Ko!==sc.Xo&&this.rh(t)},dc.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(dc.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),dc.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return Gh(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,vc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},dc),cc=(pc.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},pc.prototype.uh=function(t,e){var n=this;if(0===e)return Ju.resolve(ia.ws);var r=new ic(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},pc.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},pc.prototype.Nr=function(t,e){return this.hh.Nr(t,e)},pc.prototype.lh=function(e,n){var r=this;return this.params.Ko===sc.Xo?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),Ju.resolve(oc)):this.xr(e).next(function(t){return t<r.params.Ko?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),oc):r._h(e,n)})},pc.prototype.xr=function(t){return this.hh.xr(t)},pc.prototype._h=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>c.params.zo?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.zo+" from "+t),c.params.zo):t,s=Date.now(),c.uh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Nr(e,r)}).next(function(t){return h=Date.now(),kr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Ju.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},pc),fc=(lc.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.jn.Qr(v).next(function(t){return g=t,e=r.persistence.mr(i),m=new na(r.Eh,e,r.persistence.gr()),e.Qr(v)}).next(function(t){for(var e=[],n=[],r=Hi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Jn(v,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},lc.prototype.Vh=function(h){var c,f=this,l=Jr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Hi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Ih.Jn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Bs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ou?t.field(i.field):void 0,s=os(i.transform,o||null);null!=s&&(e=null==e?(new Ys).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Ms(o.key,s,function u(t){var a=[];return zr(t.fields||{},function(t,e){var n=new ri([t]);if(Po(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Is(a)}(s.proto.mapValue),_s.exists(!0)))}return f.jn.Lr(a,l,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Cn:e}})},lc.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},lc.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return Lr(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},lc.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},lc.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},lc.prototype.vh=function(a){var h=this,c=a.X,f=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Eh.Hs({Js:!0});f=h.dh;var s=[];a.Wt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.qi.Pi(o,t.Xt,e).next(function(){return h.qi.Ai(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.vi),f=f.nt(e,r),lc.Sh(i,r,t)&&s.push(h.qi.di(o,r))))});var t,u=ji,n=Hi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof su&&e.version.isEqual(Zr.min())?(i.$n(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.kn(e,c),u=u.nt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.ii.kr(o,t))})})),c.isEqual(Zr.min())||(t=h.qi.ai(o).next(function(t){return h.qi.ci(o,o.vi,c)}),s.push(t)),Ju.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ih.Xn(o,u)})}).then(function(t){return h.dh=f,t})},lc.Sh=function(t,e,n){return Lr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},lc.prototype.Ch=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ju.forEach(c,function(e){return Ju.forEach(e.as,function(t){return h.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return Ju.forEach(e.us,function(t){return h.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Gh(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},lc.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},lc.prototype.Nh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},lc.prototype.kh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,Ju.resolve(n)):i.qi.ri(e).next(function(t){return n=new _i(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},lc.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?Ju.resolve(this.dh.get(n)):this.qi.mi(t,e)},lc.prototype.xh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Gh(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},lc.prototype.$h=function(t,n){var r=this,i=Zr.min(),o=Hi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,mu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:Zr.min(),n?o:Hi())}).next(function(t){return{documents:t,Mh:o}})})},lc.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Ju.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);Lr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.kn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},lc.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},lc);function lc(t,e,n){this.persistence=t,this.fh=e,this.dh=new Pi(Mr),this.wh=new Xr(mi,wi),this.Th=Zr.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new na(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function pc(t,e){this.hh=t,this.params=e}function dc(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function yc(t,e){var n=t,r=n.qi,i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function vc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Yr.FAILED_PRECONDITION||e.message!==ta)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}fc.Dh=3e8;var gc=(Ic.prototype._=function(){return this.Oh._()},Ic.prototype.Ri=function(t,e){var n=new mc(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},Ic.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},Ic.prototype.gi=function(t,e){this.Wh(new mc(t,e))},Ic.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},Ic.prototype.jh=function(t){var e=this,n=new ii(new ei([])),r=new mc(n,t),i=new mc(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},Ic.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},Ic.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},Ic.prototype.Gh=function(t){var e=new ii(new ei([])),n=new mc(e,t),r=new mc(e,t+1),i=Hi();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},Ic.prototype.pi=function(t){var e=new mc(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},Ic),mc=(Ec.Lh=function(t,e){return ii.P(t.key,e.key)||Mr(t.zh,e.zh)},Ec.Bh=function(t,e){return Mr(t.zh,e.zh)||ii.P(t.key,e.key)},Ec),wc=(bc.prototype.Mr=function(){return null!=this.uid},bc.prototype.Hh=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},bc.prototype.isEqual=function(t){return t.uid===this.uid},bc);function bc(t){this.uid=t}function Ec(t,e){this.key=t,this.zh=e}function Ic(){this.Oh=new Mi(mc.Lh),this.qh=new Mi(mc.Bh)}wc.UNAUTHENTICATED=new wc(null),wc.Yh=new wc("google-credentials-uid"),wc.Jh=new wc("first-party-uid");function Tc(t,e){this.user=e,this.type="OAuth",this.Xh={},this.Xh.Authorization="Bearer "+t}var Nc,Ac,_c,Sc=(Kc.prototype.getToken=function(){return Promise.resolve(null)},Kc.prototype.ta=function(){},Kc.prototype.ea=function(t){(this.Zh=t)(wc.UNAUTHENTICATED)},Kc.prototype.na=function(){this.Zh=null},Kc),kc=(Hc.prototype.getToken=function(){var e=this,n=this.ra,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ra!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Tc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Hc.prototype.ta=function(){this.forceRefresh=!0},Hc.prototype.ea=function(t){this.Zh=t,this.ia&&t(this.currentUser)},Hc.prototype.na=function(){this.auth&&this.auth.removeAuthTokenListener(this.sa),this.sa=null,this.Zh=null},Hc.prototype.oa=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new wc(t)},Hc),Dc=(Object.defineProperty(zc.prototype,"Xh",{get:function(){var t={"X-Goog-AuthUser":this.aa},e=this.ha.auth.ua([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),zc),Pc=(Gc.prototype.getToken=function(){return Promise.resolve(new Dc(this.ha,this.aa))},Gc.prototype.ea=function(t){t(wc.Jh)},Gc.prototype.na=function(){},Gc.prototype.ta=function(){},Gc),xc=(Bc.prototype.wa=function(){return 1===this.state||2===this.state||4===this.state},Bc.prototype.Ta=function(){return 2===this.state},Bc.prototype.start=function(){3!==this.state?this.auth():this.Ea()},Bc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.wa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bc.prototype.Ia=function(){this.state=0,this.Po.reset()},Bc.prototype.ma=function(){var t=this;this.Ta()&&null===this.da&&(this.da=this.Ts.bs(this.ca,6e4,function(){return t.Aa()}))},Bc.prototype.Ra=function(t){this.Pa(),this.stream.send(t)},Bc.prototype.Aa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ta()?[2,this.close(0)]:[2]})})},Bc.prototype.Pa=function(){this.da&&(this.da.cancel(),this.da=null)},Bc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Pa(),this.Po.cancel(),this.fa++,3!==e?this.Po.reset():n&&n.code===Yr.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Yr.UNAUTHENTICATED&&this._a.ta(),null!==this.stream&&(this.ga(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Va(n)];case 1:return t.sent(),[2]}})})},Bc.prototype.ga=function(){},Bc.prototype.auth=function(){var n=this;this.state=1;var t=this.ya(this.fa),e=this.fa;this._a.getToken().then(function(t){n.fa===e&&n.pa(t)},function(e){t(function(){var t=new $r(Yr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ba(t)})})},Bc.prototype.pa=function(t){var e=this,n=this.ya(this.fa);this.stream=this.va(t),this.stream.Sa(function(){n(function(){return e.state=2,e.listener.Sa()})}),this.stream.Va(function(t){n(function(){return e.ba(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Bc.prototype.Ea=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Bc.prototype.ba=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Bc.prototype.ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.fa===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Bc),Oc=(n(Fc,_c=xc),Fc.prototype.va=function(t){return this.la.Da("Listen",t)},Fc.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Rr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Lr(void 0===i||"string"==typeof i),Ei.fromBase64String(i||"")):(Lr(void 0===i||i instanceof Uint8Array),Ei.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?Yr.UNKNOWN:Di(n.code),new $r(r,n.message||"")),f=new Xi(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=Go(t,l.document.name),d=jo(l.document.updateTime),y=new Xs({mapValue:{fields:l.document.fields}}),v=new ou(p,d,y,{}),g=l.targetIds||[],m=l.removedTargetIds||[];f=new Wi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=Go(t,w.document),E=w.readTime?jo(w.readTime):Zr.min(),I=new su(b,E),T=w.removedTargetIds||[];f=new Wi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var A=Go(t,N.document),_=N.removedTargetIds||[];f=new Wi([],_,A,null)}else{if(!("filter"in e))return Rr();e.filter;var S=e.filter;S.targetId;var k=S.count||0,D=new Ti(k),P=S.targetId;f=new Qi(P,D)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Zr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Zr.min():jo(e.readTime)}(t);return this.listener.Ca(e,n)},Fc.prototype.Fa=function(t){var e,n,r,i,o={};o.database=Ko(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=bi(i)?{documents:$o(e,i)}:{query:Jo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Uo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ra(o)},Fc.prototype.Na=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.Ra(e)},Fc),Rc=(n(qc,Ac=xc),Object.defineProperty(qc.prototype,"xa",{get:function(){return this.ka},enumerable:!1,configurable:!0}),qc.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,Ac.prototype.start.call(this)},qc.prototype.ga=function(){this.ka&&this.$a([])},qc.prototype.va=function(t){return this.la.Da("Write",t)},qc.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Lr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(Zr.min())&&(n=jo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=jo(t.commitTime);return this.listener.Ma(n,e)}var r,i;return Lr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Oa()},qc.prototype.La=function(){var t={};t.database=Ko(this.serializer),this.Ra(t)},qc.prototype.$a=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xo(e.serializer,t)})};this.Ra(n)},qc),Lc=(n(jc,Nc=function(){}),jc.prototype.Ba=function(){if(this.qa)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},jc.prototype.start=function(t){this.la=t},jc.prototype.Ua=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Ua(e,n,r,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&i.credentials.ta(),t})},jc.prototype.Wa=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Wa(e,n,r,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&i.credentials.ta(),t})},jc.prototype.Qa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.qa=!1,[2]})})},jc),Cc=(Uc.prototype.Ha=function(){var t=this;0===this.Ka&&(this.Ya("Unknown"),this.Ga=this.ao.bs("online_state_timeout",1e4,function(){return t.Ga=null,t.Ja("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},Uc.prototype.Xa=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ka++,1<=this.Ka&&(this.Za(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},Uc.prototype.set=function(t){this.Za(),this.Ka=0,"Online"===t&&(this.za=!1),this.Ya(t)},Uc.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},Uc.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Pr(e),this.za=!1):Dr("OnlineStateTracker",e)},Uc.prototype.Za=function(){null!==this.Ga&&(this.Ga.cancel(),this.Ga=null)},Uc),Vc=(Mc.prototype.start=function(){return this.enableNetwork()},Mc.prototype.enableNetwork=function(){return this.ru.delete(0),this.mu()},Mc.prototype.mu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(this.Au()?this.Ru():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Mc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(0),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Mc.prototype.gu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.nu.length&&(Dr("RemoteStore","Stopping write stream with "+this.nu.length+" pending writes"),this.nu=[]),this.Vu(),[2]}})})},Mc.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","RemoteStore shutting down."),this.ru.add(5),[4,this.gu()];case 1:return t.sent(),this.ou._r(),this.cu.set("Unknown"),[2]}})})},Mc.prototype.listen=function(t){this.su.has(t.targetId)||(this.su.set(t.targetId,t),this.Au()?this.Ru():this.lu.Ta()&&this.yu(t))},Mc.prototype.pu=function(t){this.su.delete(t),this.lu.Ta()&&this.bu(t),0===this.su.size&&(this.lu.Ta()?this.lu.ma():this.au()&&this.cu.set("Unknown"))},Mc.prototype.Me=function(t){return this.su.get(t)||null},Mc.prototype.$e=function(t){return this.vu.$e(t)},Mc.prototype.yu=function(t){this.iu.de(t.targetId),this.lu.Fa(t)},Mc.prototype.bu=function(t){this.iu.de(t),this.lu.Na(t)},Mc.prototype.Ru=function(){this.iu=new no(this),this.lu.start(),this.cu.Ha()},Mc.prototype.Au=function(){return this.au()&&!this.lu.wa()&&0<this.su.size},Mc.prototype.au=function(){return 0===this.ru.size},Mc.prototype.Vu=function(){this.iu=null},Mc.prototype._u=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.su.forEach(function(t,e){n.yu(t)}),[2]})})},Mc.prototype.fu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Vu(),this.Au()?(this.cu.Xa(e),this.Ru()):this.cu.set("Unknown"),[2]})})},Mc.prototype.du=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(i instanceof Xi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Su(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Wi?this.iu.Pe(i):i instanceof Qi?this.iu.De(i):this.iu.ye(i),o.isEqual(Zr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.tu.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Cu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Du(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Mc.prototype.Du=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Gh(n))throw n;return this.ru.add(1),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),r=r||function(){return e.tu.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.ru.delete(1),[4,this.mu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Mc.prototype.Fu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Mc.prototype.Cu=function(r){var i=this,t=this.iu.Ne(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.su.get(e))&&i.su.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.su.get(t);n&&(i.su.set(t,n.tt(Ei.Y,n.X)),i.bu(t),e=new _i(n.target,t,1,n.sequenceNumber),i.yu(e))}),this.vu.vh(t)},Mc.prototype.Su=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.su.has(i)?[4,this.vu.Nu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.su.delete(i),this.iu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Mc.prototype.Pu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.nu.length?this.nu[this.nu.length-1].batchId:-1,t.label=1;case 1:if(!this.ku())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.tu.Fh(e)];case 3:return null===(n=t.sent())?(0===this.nu.length&&this.wu.ma(),[3,7]):(e=n.batchId,this.xu(n),[3,6]);case 4:return r=t.sent(),[4,this.Du(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.$u()&&this.Mu(),[2]}})})},Mc.prototype.ku=function(){return this.au()&&this.nu.length<10},Mc.prototype.Ou=function(){return this.nu.length},Mc.prototype.xu=function(t){this.nu.push(t),this.wu.Ta()&&this.wu.xa&&this.wu.$a(t.mutations)},Mc.prototype.$u=function(){return this.au()&&!this.wu.wa()&&0<this.nu.length},Mc.prototype.Mu=function(){this.wu.start()},Mc.prototype.Tu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.wu.La(),[2]})})},Mc.prototype.Iu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.nu;e<n.length;e++)r=n[e],this.wu.$a(r.mutations);return[2]})})},Mc.prototype.Ma=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.nu.shift(),n=$u.from(e,i,o),[4,this.Fu(function(){return r.vu.Lu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Mc.prototype.Eu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.wu.xa?[4,this.qu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.$u()&&this.Mu(),[2]}})})},Mc.prototype.qu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==Yr.ABORTED?(e=this.nu.shift(),this.wu.Ia(),[4,this.Fu(function(){return r.vu.Bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Mc.prototype.uu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(4),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),this.wu.Ia(),this.lu.Ia(),this.ru.delete(4),[4,this.mu()];case 2:return t.sent(),[2]}})})},Mc.prototype.Uu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.No(),Dr("RemoteStore","RemoteStore received new credentials"),this.ru.add(3),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.vu.Uu(e)];case 2:return t.sent(),this.ru.delete(3),[4,this.mu()];case 3:return t.sent(),[2]}})})},Mc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.ru.delete(2),[4,this.mu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.ru.add(2),[4,this.gu()]);case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Mc);function Mc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.tu=t,this.eu=e,this.ao=n,this.nu=[],this.su=new Map,this.iu=null,this.ru=new Set,this.ou=i,this.ou.hu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new Cc(n,r),this.lu=(h=this.eu,c=n,f={Sa:this._u.bind(this),Va:this.fu.bind(this),Ca:this.du.bind(this)},(l=h).Ba(),new Oc(c,l.la,l.credentials,l.serializer,f)),this.wu=(o=this.eu,s=n,u={Sa:this.Tu.bind(this),Va:this.Eu.bind(this),Oa:this.Iu.bind(this),Ma:this.Ma.bind(this)},(a=o).Ba(),new Rc(s,a.la,a.credentials,a.serializer,u))}function Uc(t,e){this.ao=t,this.ja=e,this.state="Unknown",this.Ka=0,this.Ga=null,this.za=!0}function jc(t,e){var n=this;return(n=Nc.call(this)||this).credentials=t,n.serializer=e,n.qa=!1,n}function qc(t,e,n,r,i){var o=this;return(o=Ac.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function Fc(t,e,n,r,i){var o=this;return(o=_c.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Bc(t,e,n,r,i,o){this.Ts=t,this.ca=n,this.la=r,this._a=i,this.listener=o,this.state=0,this.fa=0,this.da=null,this.stream=null,this.Po=new da(t,e)}function Gc(t,e){this.ha=t,this.aa=e}function zc(t,e){this.ha=t,this.aa=e,this.type="FirstParty",this.user=wc.Jh}function Hc(t){var e=this;this.sa=null,this.currentUser=wc.UNAUTHENTICATED,this.ia=!1,this.ra=0,this.Zh=null,this.forceRefresh=!1,this.sa=function(){e.ra++,e.currentUser=e.oa(),e.ia=!0,e.Zh&&e.Zh(e.currentUser)},this.ra=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.sa):(this.sa(null),t.get().then(function(t){e.auth=t,e.sa&&e.auth.addAuthTokenListener(e.sa)},function(){}))}function Kc(){this.Zh=null}function Wc(t,e){return"firestore_clients_"+t+"_"+e}function Qc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function Xc(t,e){return"firestore_targets_"+t+"_"+e}function Yc(t){this.key=t}function $c(t){this.key=t}function Jc(t,e,n){this.query=t,this.targetId=e,this.view=n}function Zc(t){this.key=t,this.Zc=!1}var tf=(mf.Qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new $r(r.error.code,r.error.message)),i?new mf(t,e,r.state,o):(Pr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},mf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},mf),ef=(gf.Qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new $r(n.error.code,n.error.message)),r?new gf(t,n.state,i):(Pr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},gf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},gf),nf=(vf.Qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki,o=0;r&&o<n.activeTargetIds.length;++o)r=yi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new vf(t,i):(Pr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},vf),rf=(yf.Qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new yf(e.clientId,e.onlineState):(Pr("SharedClientState","Failed to parse online state: "+t),null)},yf),of=(df.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},df.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},df.prototype.ju=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},df),sf=(pf.Oi=function(t){return!(!t||!t.localStorage)},pf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.vu.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.zu&&(o=this.getItem(Wc(this.persistenceKey,i)))&&(s=nf.Qu(i,o))&&(this.Ju=this.Ju.nt(s.clientId,s));for(this.rc(),(u=this.storage.getItem(this.ic))&&(a=this.oc(u))&&this.hc(a),h=0,c=this.Xu;h<c.length;h++)f=c[h],this.Yu(f);return this.Xu=[],this.window.addEventListener("unload",function(){return l._r()}),this.Hi=!0,[2]}})})},pf.prototype.ds=function(t){this.setItem(this.tc,JSON.stringify(t))},pf.prototype.ac=function(){return this.uc(this.Ju)},pf.prototype.cc=function(n){var r=!1;return this.Ju.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},pf.prototype.lc=function(t){this._c(t,"pending")},pf.prototype.fc=function(t,e,n){this._c(t,e,n),this.dc(t)},pf.prototype.wc=function(t){var e,n,r="not-current";return this.cc(t)&&(!(e=this.storage.getItem(Xc(this.persistenceKey,t)))||(n=ef.Qu(t,e))&&(r=n.state)),this.Tc.Ku(t),this.rc(),r},pf.prototype.Ec=function(t){this.Tc.Gu(t),this.rc()},pf.prototype.Ic=function(t){return this.Tc.activeTargetIds.has(t)},pf.prototype.mc=function(t){this.removeItem(Xc(this.persistenceKey,t))},pf.prototype.Ac=function(t,e,n){this.Rc(t,e,n)},pf.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.dc(t)}),this.currentUser=t,n.forEach(function(t){r.lc(t)})},pf.prototype.Pc=function(t){this.gc(t)},pf.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.Hu),this.removeItem(this.Zu),this.Hi=!1)},pf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},pf.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},pf.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},pf.prototype.Yu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Dr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Zu)return void Pr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.ec.test(u.key)){if(null==u.newValue)return e=this.Vc(u.key),[2,this.yc(e,null)];if(n=this.pc(u.key,u.newValue))return[2,this.yc(n.clientId,n)]}else if(this.nc.test(u.key)){if(null!==u.newValue&&(r=this.bc(u.key,u.newValue)))return[2,this.vc(r)]}else if(this.sc.test(u.key)){if(null!==u.newValue&&(i=this.Sc(u.key,u.newValue)))return[2,this.Dc(i)]}else if(u.key===this.ic){if(null!==u.newValue&&(o=this.oc(u.newValue)))return[2,this.hc(o)]}else u.key===this.tc&&(s=function(t){var e=ia.ws;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){Pr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==ia.ws&&this.ls(s)}else this.Xu.push(u);return[2]})})})}},Object.defineProperty(pf.prototype,"Tc",{get:function(){return this.Ju.get(this.zu)},enumerable:!1,configurable:!0}),pf.prototype.rc=function(){this.setItem(this.Zu,this.Tc.ju())},pf.prototype._c=function(t,e,n){var r=new tf(this.currentUser,t,e,n),i=Qc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ju())},pf.prototype.dc=function(t){var e=Qc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},pf.prototype.gc=function(t){var e={clientId:this.zu,onlineState:t};this.storage.setItem(this.ic,JSON.stringify(e))},pf.prototype.Rc=function(t,e,n){var r=Xc(this.persistenceKey,t),i=new ef(t,e,n);this.setItem(r,i.ju())},pf.prototype.Vc=function(t){var e=this.ec.exec(t);return e?e[1]:null},pf.prototype.pc=function(t,e){var n=this.Vc(t);return nf.Qu(n,e)},pf.prototype.bc=function(t,e){var n=this.nc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return tf.Qu(new wc(i),r,e)},pf.prototype.Sc=function(t,e){var n=this.sc.exec(t),r=Number(n[1]);return ef.Qu(r,e)},pf.prototype.oc=function(t){return rf.Qu(t)},pf.prototype.vc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.vu.Cc(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},pf.prototype.Dc=function(t){return this.vu.Fc(t.targetId,t.state,t.error)},pf.prototype.yc=function(t,e){var n=this,r=e?this.Ju.nt(t,e):this.Ju.remove(t),i=this.uc(this.Ju),o=this.uc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.vu.Nc(s,u).then(function(){n.Ju=r})},pf.prototype.hc=function(t){this.Ju.get(t.clientId)&&this.ja(t.onlineState)},pf.prototype.uc=function(t){var n=Ki;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},pf),uf=(lf.prototype.lc=function(t){},lf.prototype.fc=function(t,e,n){},lf.prototype.wc=function(t){return this.kc.Ku(t),this.xc[t]||"not-current"},lf.prototype.Ac=function(t,e,n){this.xc[t]=e},lf.prototype.Ec=function(t){this.kc.Gu(t)},lf.prototype.Ic=function(t){return this.kc.activeTargetIds.has(t)},lf.prototype.mc=function(t){delete this.xc[t]},lf.prototype.ac=function(){return this.kc.activeTargetIds},lf.prototype.cc=function(t){return this.kc.activeTargetIds.has(t)},lf.prototype.start=function(){return this.kc=new of,Promise.resolve()},lf.prototype.Ah=function(t,e,n){},lf.prototype.Pc=function(t){},lf.prototype._r=function(){},lf.prototype.ds=function(t){},lf),af=(Object.defineProperty(ff.prototype,"Bc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),ff.prototype.Uc=function(t,e){var u=this,a=e?e.Wc:new $i,h=e?e.qc:this.qc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof ou?e:null)&&(Au(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Qc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Lc(r,p)||d&&u.Lc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{qc:f,Wc:a,jc:l,Lt:c}},ff.prototype.Qc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},ff.prototype.qn=function(t,e,n){var o=this,r=this.qc;this.qc=t.qc,this.Lt=t.Lt;var i=t.Wc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Lc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.Kc(n);var s=e?this.Gc():[],u=0===this.Oc.size&&this.Ht?1:0,a=u!==this.Mc;return this.Mc=u,0!==i.length||a?{snapshot:new Ji(this.query,t.qc,r,i,t.Lt,0==u,a,!1),zc:s}:{zc:s}},ff.prototype.Hc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({qc:this.qc,Wc:new $i,Lt:this.Lt,jc:!1},!1)):{zc:[]}},ff.prototype.Yc=function(t){return!this.$c.has(t)&&!!this.qc.has(t)&&!this.qc.get(t).Ke},ff.prototype.Kc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.$c=e.$c.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.$c=e.$c.delete(t)}),this.Ht=t.Ht)},ff.prototype.Gc=function(){var e=this;if(!this.Ht)return[];var n=this.Oc;this.Oc=Hi(),this.qc.forEach(function(t){e.Yc(t.key)&&(e.Oc=e.Oc.add(t.key))});var r=[];return n.forEach(function(t){e.Oc.has(t)||r.push(new $c(t))}),this.Oc.forEach(function(t){n.has(t)||r.push(new Yc(t))}),r},ff.prototype.Jc=function(t){this.$c=t.Mh,this.Oc=Hi();var e=this.Uc(t.documents);return this.qn(e,!0)},ff.prototype.Xc=function(){return Ji.Ut(this.query,this.qc,this.Lt,0===this.Mc)},ff),hf=(Object.defineProperty(cf.prototype,"dl",{get:function(){return!0===this.fl},enumerable:!1,configurable:!0}),cf.prototype.subscribe=function(t){this.sl=t},cf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.wl("listen()"),(r=this.il.get(s))?(e=r.targetId,this.el.wc(e),n=r.view.Xc(),[3,4]):[3,1];case 1:return[4,this.tu.kh(mu(s))];case 2:return i=t.sent(),o=this.el.wc(i.targetId),e=i.targetId,[4,this.Tl(s,e,"current"===o)];case 3:n=t.sent(),this.dl&&this.tl.listen(i),t.label=4;case 4:return[2,n]}})})},cf.prototype.Tl=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.tu.$h(u,!0)];case 1:return e=t.sent(),n=new af(u,e.Mh),r=n.Uc(e.documents),i=to.zt(a,h&&"Offline"!==this.onlineState),o=n.qn(r,this.dl,i),this.El(a,o.zc),s=new Jc(u,a,n),[2,(this.il.set(u,s),this.rl.has(a)?this.rl.get(a).push(u):this.rl.set(a,[u]),o.snapshot)]}})})},cf.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.wl("unlisten()"),e=this.il.get(i),1<(n=this.rl.get(e.targetId)).length?[2,(this.rl.set(e.targetId,n.filter(function(t){return!Iu(t,i)})),void this.il.delete(i))]:this.dl?(this.el.Ec(e.targetId),this.el.cc(e.targetId)?[3,2]:[4,this.tu.xh(e.targetId,!1).then(function(){r.el.mc(e.targetId),r.tl.pu(e.targetId),r.Il(e.targetId)}).catch(vc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Il(e.targetId),[4,this.tu.xh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},cf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.wl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.tu.Vh(i)];case 2:return e=t.sent(),this.el.lc(e.batchId),this.ml(e.batchId,o),[4,this.Al(e.Cn)];case 3:return t.sent(),[4,this.tl.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=nc(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},cf.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.wl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.al.get(e);n&&(Lr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Zc=!0:0<t.Jt.size?Lr(n.Zc):0<t.Xt.size&&(Lr(n.Zc),n.Zc=!1))}),[4,this.Al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,vc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},cf.prototype.Hc=function(r,t){var i;(this.dl&&0===t||!this.dl&&1===t)&&(this.wl("applyOnlineStateChange()"),i=[],this.il.forEach(function(t,e){var n=e.view.Hc(r);n.snapshot&&i.push(n.snapshot)}),this.sl.Rl(r),this.sl.Ca(i),this.onlineState=r,this.dl&&this.el.Pc(r))},cf.prototype.Nu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.wl("rejectListens()"),this.el.Ac(u,"rejected",a),e=this.al.get(u),(n=e&&e.key)?(r=(r=new Pi(ii.P)).nt(n,new su(n,Zr.min())),i=Hi().add(n),o=new Zi(Zr.min(),new Map,new Mi(Mr),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.hl=this.hl.remove(n),this.al.delete(u),this.Pl(),[3,4];case 2:return[4,this.tu.xh(u,!1).then(function(){return s.Il(u,a)}).catch(vc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},cf.prototype.Lu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.wl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.yh(r)];case 2:return n=t.sent(),this.gl(e,null),this.Vl(e),this.el.fc(e,"acknowledged"),[4,this.Al(n)];case 3:return t.sent(),[3,6];case 4:return[4,vc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},cf.prototype.Bu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.wl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.bh(n)];case 2:return e=t.sent(),this.gl(n,r),this.Vl(n),this.el.fc(n,"rejected",r),[4,this.Al(e)];case 3:return t.sent(),[3,6];case 4:return[4,vc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},cf.prototype.yl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.tl.au()||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.tu.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.ll.get(e)||[]).push(o),this.ll.set(e,n),[3,4]);case 3:return r=t.sent(),i=nc(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},cf.prototype.Vl=function(t){(this.ll.get(t)||[]).forEach(function(t){t.resolve()}),this.ll.delete(t)},cf.prototype.pl=function(e){this.ll.forEach(function(t){t.forEach(function(t){t.reject(new $r(Yr.CANCELLED,e))})}),this.ll.clear()},cf.prototype.ml=function(t,e){var n=this.cl[this.currentUser.Hh()];n=(n=n||new Pi(Mr)).nt(t,e),this.cl[this.currentUser.Hh()]=n},cf.prototype.gl=function(t,e){var n,r=this.cl[this.currentUser.Hh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.cl[this.currentUser.Hh()]=r)},cf.prototype.Il=function(t,e){var n=this;void 0===e&&(e=null),this.el.Ec(t);for(var r=0,i=this.rl.get(t);r<i.length;r++){var o=i[r];this.il.delete(o),e&&this.sl.bl(o,e)}this.rl.delete(t),this.dl&&this.ul.jh(t).forEach(function(t){n.ul.pi(t)||n.vl(t)})},cf.prototype.vl=function(t){var e=this.hl.get(t);null!==e&&(this.tl.pu(e),this.hl=this.hl.remove(t),this.al.delete(e),this.Pl())},cf.prototype.El=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Yc?(this.ul.Ri(i.key,t),this.Sl(i)):i instanceof $c?(Dr("SyncEngine","Document no longer in limbo: "+i.key),this.ul.gi(i.key,t),this.ul.pi(i.key)||this.vl(i.key)):Rr()}},cf.prototype.Sl=function(t){var e=t.key;this.hl.get(e)||(Dr("SyncEngine","New document in limbo: "+e),this.ol.push(e),this.Pl())},cf.prototype.Pl=function(){for(;0<this.ol.length&&this.hl.size<this.nl;){var t=this.ol.shift(),e=this._l.next();this.al.set(e,new Zc(t)),this.hl=this.hl.nt(t,e),this.tl.listen(new _i(mu(yu(t.path)),e,2,ia.ws))}},cf.prototype.Dl=function(){return this.hl},cf.prototype.Cl=function(){return this.ol},cf.prototype.Al=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.il.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Uc(r);return n.jc?u.tu.$h(i.query,!1).then(function(t){var e=t.documents;return i.view.Uc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.qn(t,u.dl,n);u.El(i.targetId,r.zc),r.snapshot&&(u.dl&&u.el.Ac(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ra.cs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.sl.Ca(o),[4,this.tu.Ch(s)];case 2:return t.sent(),[2]}})})},cf.prototype.wl=function(t){},cf.prototype.Uu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Dr("SyncEngine","User change. New user:",n.Hh()),[4,this.tu.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.pl("'waitForPendingWrites' promise is rejected due to a user change."),this.el.Ah(n,e.Ph,e.gh),[4,this.Al(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},cf.prototype.$e=function(t){var e=this.al.get(t);if(e&&e.Zc)return Hi().add(e.key);var n=Hi(),r=this.rl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.il.get(s),n=n.Ct(u.view.Bc);return n},cf);function cf(t,e,n,r,i,o){this.tu=t,this.tl=e,this.eu=n,this.el=r,this.currentUser=i,this.nl=o,this.sl=null,this.il=new Xr(Tu,Iu),this.rl=new Map,this.ol=[],this.hl=new Pi(ii.P),this.al=new Map,this.ul=new gc,this.cl={},this.ll=new Map,this._l=za.si(),this.onlineState="Unknown",this.fl=void 0}function ff(t,e){this.query=t,this.$c=e,this.Mc=null,this.Ht=!1,this.Oc=Hi(),this.Lt=Hi(),this.Lc=_u(t),this.qc=new Yi(this.Lc)}function lf(){this.kc=new of,this.xc={},this.ja=null,this.ls=null}function pf(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.zu=r,this.vu=null,this.ja=null,this.ls=null,this.Hu=this.Yu.bind(this),this.Ju=new Pi(Mr),this.Hi=!1,this.Xu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Zu=Wc(this.persistenceKey,this.zu),this.tc="firestore_sequence_number_"+this.persistenceKey,this.Ju=this.Ju.nt(this.zu,new of),this.ec=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.nc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.sc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ic="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Hu)}function df(){this.activeTargetIds=Ki}function yf(t,e){this.clientId=t,this.onlineState=e}function vf(t,e){this.clientId=t,this.activeTargetIds=e}function gf(t,e,n){this.targetId=t,this.state=e,this.error=n}function mf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function wf(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).wl("applyBatchState()"),[4,(e=o.tu,n=a,i=(r=e).jn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.Ih.Jn(e,t):Ju.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.tl.Pu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.gl(a,c||null),o.tu.jn.Gr(a)):Rr(),t.label=4;case 4:return[4,o.Al(s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function bf(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.fl?[3,3]:(e=r.el.ac(),[4,Ef(r,e.F())]);case 1:return i=t.sent(),r.fl=!0,[4,r.tl.Wu(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.tl.listen(u);return[3,7];case 3:return!1!==f||!1===r.fl?[3,7]:(a=[],h=Promise.resolve(),r.rl.forEach(function(t,e){r.el.Ic(e)?a.push(e):h=h.then(function(){return r.Il(e),r.tu.xh(e,!0)}),r.tl.pu(e)}),[4,h]);case 4:return t.sent(),[4,Ef(r,a)];case 5:return t.sent(),(n=r).al.forEach(function(t,e){n.tl.pu(e)}),n.ul.Kh(),n.al=new Map,n.hl=new Pi(ii.P),r.fl=!1,[4,r.tl.Wu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Ef(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.rl.get(s))&&0!==a.length?[4,e.tu.kh(mu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.il.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).tu.$h(o.query,!0)];case 1:return n=t.sent(),r=o.view.Jc(n),[2,(e.dl&&e.El(o.targetId,r.zc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,yc(e.tu,s)];case 8:return d=t.sent(),[4,e.tu.kh(d)];case 9:return u=t.sent(),[4,e.Tl(If(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.sl.Ca(r),n)]}})})}function If(t){return du(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Tf(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).fl?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.rl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.tu,e=r.Eh,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=Zi.Gt(u,"current"===a),[4,n.Al(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.tu.xh(u,!0)];case 6:return t.sent(),n.Il(u,h),[3,8];case 7:Rr(),t.label=8;case 8:return[2]}var r,e})})}function Nf(){this.Fl=void 0,this.listeners=[]}var Af,_f=(Cf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Nl.get(e))||(n=!0,r=new Nf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.vu.listen(e)];case 2:return i.Fl=t.sent(),[3,4];case 3:return o=t.sent(),s=nc(o,"Initialization of query '"+Nu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.Nl.set(e,r),r.listeners.push(u),u.Hc(this.onlineState),r.Fl&&u.xl(r.Fl)&&this.$l(),[2]}})})},Cf.prototype.pu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.Nl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.Nl.delete(e),this.vu.pu(e))]:[2]})})},Cf.prototype.Ca=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].xl(i)&&(e=!0);s.Fl=i}}e&&this.$l()},Cf.prototype.bl=function(t,e){var n=this.Nl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Nl.delete(t)},Cf.prototype.Rl=function(i){this.onlineState=i;var o=!1;this.Nl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Hc(i)&&(o=!0)}),o&&this.$l()},Cf.prototype.Ml=function(t){this.kl.add(t),t.next()},Cf.prototype.Ol=function(t){this.kl.delete(t)},Cf.prototype.$l=function(){this.kl.forEach(function(t){t.next()})},Cf),Sf=(Lf.prototype.xl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ji(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.ql?this.Ul(t)&&(this.Ll.next(t),o=!0):this.Wl(t,this.onlineState)&&(this.Ql(t),o=!0),this.Bl=t,o},Lf.prototype.onError=function(t){this.Ll.error(t)},Lf.prototype.Hc=function(t){this.onlineState=t;var e=!1;return this.Bl&&!this.ql&&this.Wl(this.Bl,t)&&(this.Ql(this.Bl),e=!0),e},Lf.prototype.Wl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.jl&&n||t.docs._()&&"Offline"!==e)},Lf.prototype.Ul=function(t){if(0<t.docChanges.length)return!0;var e=this.Bl&&this.Bl.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Lf.prototype.Ql=function(t){t=Ji.Ut(t.query,t.docs,t.Lt,t.fromCache),this.ql=!0,this.Ll.next(t)},Lf),kf=(Rf.prototype.mh=function(t){this.Kl=t},Rf.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Zr.min())?this.Gl(e,r):this.Kl.Jn(e,o).next(function(t){var n=s.zl(r,t);return(r.hn()||r.an())&&s.jc(r.en,n,o,i)?s.Gl(e,r):(kr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nu(r)),s.Kl.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Rf.prototype.zl=function(n,t){var r=new Mi(_u(n));return t.forEach(function(t,e){e instanceof ou&&Au(n,e)&&(r=r.add(e))}),r},Rf.prototype.jc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Rf.prototype.Gl=function(t,e){return kr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Nu(e)),this.Kl.ts(t,e,Zr.min())},Rf),Df=(Of.prototype.Or=function(t){return Ju.resolve(0===this.jn.length)},Of.prototype.Lr=function(t,e,n,r){var i=this.Hl;this.Hl++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new Yu(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Yl=this.Yl.add(new mc(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return Ju.resolve(o)},Of.prototype.qr=function(t,e){return Ju.resolve(this.Jl(e))},Of.prototype.Ur=function(t,e){var n=e+1,r=this.Xl(n),i=r<0?0:r;return Ju.resolve(this.jn.length>i?this.jn[i]:null)},Of.prototype.Wr=function(){return Ju.resolve(0===this.jn.length?-1:this.Hl-1)},Of.prototype.Qr=function(t){return Ju.resolve(this.jn.slice())},Of.prototype.zn=function(t,e){var n=this,r=new mc(e,0),i=new mc(e,Number.POSITIVE_INFINITY),o=[];return this.Yl.vt([r,i],function(t){var e=n.Jl(t.zh);o.push(e)}),Ju.resolve(o)},Of.prototype.Zn=function(t,e){var r=this,i=new Mi(Mr);return e.forEach(function(t){var e=new mc(t,0),n=new mc(t,Number.POSITIVE_INFINITY);r.Yl.vt([e,n],function(t){i=i.add(t.zh)})}),Ju.resolve(this.Zl(i))},Of.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;ii.W(i)||(i=i.child(""));var o=new mc(new ii(i),0),s=new Mi(Mr);return this.Yl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),Ju.resolve(this.Zl(s))},Of.prototype.Zl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&r.push(e)}),r},Of.prototype.Kr=function(n,r){var i=this;Lr(0===this.t_(r.batchId,"removed")),this.jn.shift();var o=this.Yl;return Ju.forEach(r.mutations,function(t){var e=new mc(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.Yl=o})},Of.prototype.Gr=function(t){},Of.prototype.pi=function(t,e){var n=new mc(e,0),r=this.Yl.Dt(n);return Ju.resolve(e.isEqual(r&&r.key))},Of.prototype.zr=function(t){return this.jn.length,Ju.resolve()},Of.prototype.t_=function(t,e){return this.Xl(t)},Of.prototype.Xl=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},Of.prototype.Jl=function(t){var e=this.Xl(t);return e<0||e>=this.jn.length?null:this.jn[e]},Of),Pf=(xf.prototype.kn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.e_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},xf.prototype.$n=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},xf.prototype.Mn=function(t,e){var n=this.docs.get(e);return Ju.resolve(n?n.Ls:null)},xf.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),Ju.resolve(r)},xf.prototype.ts=function(t,e,n){for(var r=Bi,i=new ii(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ls,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof ou&&Au(e,h)&&(r=r.nt(h.key,h))}return Ju.resolve(r)},xf.prototype.n_=function(t,e){return Ju.forEach(this.docs,function(t){return e(t)})},xf.prototype.Hs=function(t){return new xf.Ys(this)},xf.prototype.Xs=function(t){return Ju.resolve(this.size)},xf);function xf(t,e){this.Kn=t,this.e_=e,this.docs=new Pi(ii.P),this.size=0}function Of(t,e){this.Kn=t,this.ii=e,this.jn=[],this.Hl=1,this.Yl=new Mi(mc.Lh)}function Rf(){}function Lf(t,e,n){this.query=t,this.Ll=e,this.ql=!1,this.Bl=null,this.onlineState="Unknown",this.options=n||{}}function Cf(t){this.vu=t,this.Nl=new Xr(Tu,Iu),this.onlineState="Unknown",this.kl=new Set,this.vu.subscribe(this)}function Vf(t){var e=this;return(e=Af.call(this)||this).Zs=t,e}Pf.Ys=(n(Vf,Af=Zu),Vf.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.kn(n,e,r.readTime)):r.Zs.$n(t)}),Ju.Sn(i)},Vf.prototype.On=function(t,e){return this.Zs.Mn(t,e)},Vf.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},Vf);var Mf,Uf,jf=(nl.prototype.pe=function(t,n){return this.s_.forEach(function(t,e){return n(e)}),Ju.resolve()},nl.prototype.ai=function(t){return Ju.resolve(this.lastRemoteSnapshotVersion)},nl.prototype.ui=function(t){return Ju.resolve(this.i_)},nl.prototype.ri=function(t){return this.highestTargetId=this.o_.next(),Ju.resolve(this.highestTargetId)},nl.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.i_&&(this.i_=e),Ju.resolve()},nl.prototype._i=function(t){this.s_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.o_=new za(e),this.highestTargetId=e),t.sequenceNumber>this.i_&&(this.i_=t.sequenceNumber)},nl.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,Ju.resolve()},nl.prototype.di=function(t,e){return this._i(e),Ju.resolve()},nl.prototype.wi=function(t,e){return this.s_.delete(e.target),this.r_.jh(e.targetId),--this.targetCount,Ju.resolve()},nl.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.s_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.s_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),Ju.Sn(u).next(function(){return s})},nl.prototype.Ii=function(t){return Ju.resolve(this.targetCount)},nl.prototype.mi=function(t,e){var n=this.s_.get(e)||null;return Ju.resolve(n)},nl.prototype.Ai=function(t,e,n){return this.r_.Uh(e,n),Ju.resolve()},nl.prototype.Pi=function(e,t,n){this.r_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),Ju.Sn(i)},nl.prototype.Ti=function(t,e){return this.r_.jh(e),Ju.resolve()},nl.prototype.Vi=function(t,e){var n=this.r_.Gh(e);return Ju.resolve(n)},nl.prototype.pi=function(t,e){return Ju.resolve(this.r_.pi(e))},nl),qf=(el.prototype.start=function(){return Promise.resolve()},el.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(el.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),el.prototype.Yi=function(){},el.prototype.Xi=function(){},el.prototype.gr=function(){return this.Kn},el.prototype.mr=function(t){var e=this.h_[t.Hh()];return e||(e=new Df(this.Kn,this.ii),this.h_[t.Hh()]=e),e},el.prototype.Rr=function(){return this.qi},el.prototype.Pr=function(){return this.Qn},el.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Ff(this.Ci.next());return this.ii.u_(),n(i).next(function(t){return r.ii.c_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},el.prototype.l_=function(e,n){return Ju.Dn(Object.values(this.h_).map(function(t){return function(){return t.pi(e,n)}}))},el),Ff=(n(tl,Uf=ea),tl),Bf=(Zf.d_=function(t){return new Zf(t)},Object.defineProperty(Zf.prototype,"w_",{get:function(){if(this.f_)return this.f_;throw Rr()},enumerable:!1,configurable:!0}),Zf.prototype.Ri=function(t,e,n){return this.__.Ri(n,e),this.w_.delete(n),Ju.resolve()},Zf.prototype.gi=function(t,e,n){return this.__.gi(n,e),this.w_.add(n),Ju.resolve()},Zf.prototype.Dr=function(t,e){return this.w_.add(e),Ju.resolve()},Zf.prototype.removeTarget=function(t,e){var n=this;this.__.jh(e.targetId).forEach(function(t){return n.w_.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.w_.add(t)})}).next(function(){return r.wi(t,e)})},Zf.prototype.u_=function(){this.f_=new Set},Zf.prototype.c_=function(t){var n=this,r=this.persistence.Pr().Hs();return Ju.forEach(this.w_,function(e){return n.T_(t,e).next(function(t){t||r.$n(e)})}).next(function(){return n.f_=null,r.apply(t)})},Zf.prototype.kr=function(t,e){var n=this;return this.T_(t,e).next(function(t){t?n.w_.delete(e):n.w_.add(e)})},Zf.prototype.a_=function(t){return 0},Zf.prototype.T_=function(t,e){var n=this;return Ju.Dn([function(){return Ju.resolve(n.__.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.l_(t,e)}])},Zf),Gf=(Jf.prototype.Sa=function(t){this.m_=t},Jf.prototype.Va=function(t){this.A_=t},Jf.prototype.onMessage=function(t){this.R_=t},Jf.prototype.close=function(){this.I_()},Jf.prototype.send=function(t){this.E_(t)},Jf.prototype.P_=function(){this.m_()},Jf.prototype.g_=function(t){this.A_(t)},Jf.prototype.V_=function(t){this.R_(t)},Jf),zf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Hf=($f.prototype.Ua=function(e,t,n,r){var i=this.v_(e,t);Dr("RestConnection","Sending: ",i,n);var o={};return this.S_(o,r),this.D_(e,i,o,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},$f.prototype.Wa=function(t,e,n,r){return this.Ua(t,e,n,r)},$f.prototype.S_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2",t["Content-Type"]="text/plain",e)for(var n in e.Xh)e.Xh.hasOwnProperty(n)&&(t[n]=e.Xh[n])},$f.prototype.v_=function(t,e){var n=zf[t];return this.p_+"/v1/"+e+":"+n},n(Yf,Mf=$f),Yf.prototype.D_=function(a,e,n,r){return new Promise(function(o,s){var u=new Nr;u.listenOnce(Ir.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var t=u.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:Dr("Connection",'RPC "'+a+'" timed out'),s(new $r(Yr.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=u.getStatus();Dr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Yr).indexOf(i)?i:Yr.UNKNOWN,s(new $r(n,e.message))):s(new $r(Yr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new $r(Yr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Dr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},Yf.prototype.Da=function(t,e){var n,r,i=[this.p_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=br(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.S_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Dr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Gf({E_:function(t){f?Dr("Connection","Not sending because WebChannel is closed:",t):(c||(Dr("Connection","Opening WebChannel transport."),h.open(),c=!0),Dr("Connection","WebChannel sending:",t),h.send(t))},I_:function(){return h.close()}});return a(Tr.EventType.OPEN,function(){f||Dr("Connection","WebChannel transport opened.")}),a(Tr.EventType.CLOSE,function(){f||(f=!0,Dr("Connection","WebChannel transport closed"),l.g_())}),a(Tr.EventType.ERROR,function(t){f||(f=!0,xr("Connection","WebChannel transport errored:",t),l.g_(new $r(Yr.UNAVAILABLE,"The operation could not be completed")))}),a(Tr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Lr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Dr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ni[i];if(void 0!==t)return Di(t)}(),s=r.message,void 0===o&&(o=Yr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.g_(new $r(o,s)),h.close()):(Dr("Connection","WebChannel received:",n),l.V_(n)))}),setTimeout(function(){l.P_()},0),l},Yf),Kf=(Xf.prototype.hu=function(t){this.x_.push(t)},Xf.prototype._r=function(){window.removeEventListener("online",this.C_),window.removeEventListener("offline",this.N_)},Xf.prototype.M_=function(){window.addEventListener("online",this.C_),window.addEventListener("offline",this.N_)},Xf.prototype.F_=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(0)},Xf.prototype.k_=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(1)},Xf.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Xf),Wf=(Qf.prototype.hu=function(t){},Qf.prototype._r=function(){},Qf);function Qf(){}function Xf(){var t=this;this.C_=function(){return t.F_()},this.N_=function(){return t.k_()},this.x_=[],this.M_()}function Yf(t){var e=this;return(e=Mf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function $f(t){this.y_=t,this.s=t.s;var e=t.ssl?"https":"http";this.p_=e+"://"+t.host,this.b_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Jf(t){this.E_=t.E_,this.I_=t.I_}function Zf(t){this.persistence=t,this.__=new gc,this.f_=null}function tl(t){var e=this;return(e=Uf.call(this)||this).vi=t,e}function el(t){var e=this;this.h_={},this.Ci=new ia(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new jf(this),this.Kn=new wa,this.Qn=new Pf(this.Kn,function(t){return e.ii.a_(t)})}function nl(t){this.persistence=t,this.s_=new Xr(mi,wi),this.lastRemoteSnapshotVersion=Zr.min(),this.highestTargetId=0,this.i_=0,this.r_=new gc,this.targetCount=0,this.o_=za.ni()}function rl(t){return new Ro(t,!0)}var il,ol,sl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ul=(pl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.el=this.O_(e),this.persistence=this.L_(e),[4,this.persistence.start()];case 1:return t.sent(),this.q_=this.B_(e),this.tu=this.U_(e),[2]}})})},pl.prototype.B_=function(t){return null},pl.prototype.U_=function(t){return e=this.persistence,n=new kf,r=t.W_,new fc(e,n,r);var e,n,r},pl.prototype.L_=function(t){if(t.j_.Q_)throw new $r(Yr.FAILED_PRECONDITION,sl);return new qf(Bf.d_)},pl.prototype.O_=function(t){return new uf},pl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.el._r()];case 1:return t.sent(),[4,this.persistence._r()];case 2:return t.sent(),[2]}})})},pl.prototype.clearPersistence=function(t,e){throw new $r(Yr.FAILED_PRECONDITION,sl)},pl),al=(n(ll,ol=ul),ll.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,ol.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Eh,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.tu)];case 2:return t.sent(),[2]}})})},ll.prototype.B_=function(t){var e=this.persistence.ii.yr;return new hc(e,t.ao)},ll.prototype.L_=function(t){var e=ah(t.y_.s,t.y_.persistenceKey),n=rl(t.y_.s);return new th(t.j_.synchronizeTabs,e,t.clientId,sc.Ho(t.j_.cacheSizeBytes),t.ao,$h(),"undefined"!=typeof document?document:null,n,this.el,t.j_.Di)},ll.prototype.O_=function(t){return new uf},ll.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Mh.Oi()?(e=n+"main",[4,Mh.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(ah(t,e))},n(fl,il=ll),fl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,il.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.K_.initialize(this,r)];case 2:return t.sent(),e=this.K_.vu,this.el instanceof sf?(this.el.vu={Cc:wf.bind(null,e),Fc:Tf.bind(null,e),Nc:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).fl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.rl.has(i)?(Dr("SyncEngine","Adding an already active target "+i),[3,5]):[4,yc(n.tu,i)]):[3,6];case 2:return o=t.sent(),[4,n.tu.kh(o)];case 3:return s=t.sent(),[4,n.Tl(If(o),s.targetId,!1)];case 4:t.sent(),n.tl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.rl.has(e)?[4,n.tu.xh(e,!1).then(function(){n.tl.pu(e),n.Il(e)}).catch(vc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Ir:function(t){return t.tu.persistence.Ir()}.bind(null,e)},[4,this.el.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,bf(this.K_.vu,e)];case 1:return t.sent(),this.q_&&(e&&!this.q_.Hi?this.q_.start(this.tu):e||this.q_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},fl.prototype.O_=function(t){if(t.j_.Q_&&t.j_.synchronizeTabs){var e=$h();if(!sf.Oi(e))throw new $r(Yr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ah(t.y_.s,t.y_.persistenceKey);return new sf(e,t.ao,n,t.clientId,t.W_)}return new uf},fl),hl=(cl.prototype.initialize=function(r,i){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.tu?[2]:(this.tu=r.tu,this.el=r.el,this.eu=this.G_(i),[4,this.z_(i)]);case 1:return e=t.sent(),this.eu.start(e),this.tl=this.H_(i),this.vu=this.Y_(i),this.J_=this.X_(i),this.el.ja=function(t){return n.vu.Hc(t,1)},this.tl.vu=this.vu,[4,this.tl.start()];case 2:return t.sent(),[4,this.tl.Wu(this.vu.dl)];case 3:return t.sent(),[2]}})})},cl.prototype.z_=function(t){return e=t.y_,Promise.resolve(new Hf(e));var e},cl.prototype.X_=function(t){return new _f(this.vu)},cl.prototype.G_=function(t){var e,n=rl(t.y_.s);return e=t.credentials,new Lc(e,n)},cl.prototype.H_=function(t){var e=this;return new Vc(this.tu,this.eu,t.ao,function(t){return e.vu.Hc(t,0)},new(Kf.Oi()?Kf:Wf))},cl.prototype.Y_=function(t){return e=this.tu,n=this.tl,r=this.eu,i=this.el,o=t.W_,s=t.nl,u=!t.j_.Q_||!t.j_.synchronizeTabs,a=new hf(e,n,r,i,o,s),u&&(a.fl=!0),a;var e,n,r,i,o,s,u,a},cl.prototype.terminate=function(){return this.tl._r()},cl);function cl(){}function fl(t){var e=this;return(e=il.call(this)||this).K_=t,e}function ll(){return null!==ol&&ol.apply(this,arguments)||this}function pl(){}function dl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var yl=(vl.prototype.next=function(t){this.observer.next&&this.Z_(this.observer.next,t)},vl.prototype.error=function(t){this.observer.error?this.Z_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},vl.prototype.tf=function(){this.muted=!0},vl.prototype.Z_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},vl);function vl(t){this.observer=t,this.muted=!1}function gl(t,e){if(0!==e.length)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Cl(e.length,"argument")+".")}function ml(t,e,n){if(e.length!==n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires "+Cl(n,"argument")+", but was called with "+Cl(e.length,"argument")+".")}function wl(t,e,n){if(e.length<n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Cl(n,"argument")+", but was called with "+Cl(e.length,"argument")+".")}function bl(t,e,n,r){if(e.length<n||e.length>r)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Cl(e.length,"argument")+".")}function El(t,e,n,r){Sl(t,e,Ll(n)+" argument",r)}function Il(t,e,n,r){void 0!==r&&El(t,e,n,r)}function Tl(t,e,n,r){Sl(t,e,n+" option",r)}function Nl(t,e,n,r){void 0!==r&&Tl(t,e,n,r)}function Al(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Dl(s))}var u=Dl(n);throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function _l(t,e,n,r){if(!e.some(function(t){return t===r}))throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+Dl(r)+" provided to function "+t+"() for its "+Ll(n)+" argument. Acceptable values: "+e.join(", "));return r}function Sl(t,e,n,r){if(!("object"===e?kl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Dl(r);throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function kl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Dl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Pl(t,e,n){if(void 0===n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ll(e)+" argument, but it was undefined.")}function xl(n,t,r){zr(t,function(t,e){if(r.indexOf(t)<0)throw new $r(Yr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Ol(t,e,n,r){var i=Dl(r);return new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ll(n)+" argument to be a "+e+", but it was: "+i)}function Rl(t,e,n){if(n<=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ll(e)+" argument to be a positive number, but it was: "+n+".")}function Ll(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Cl(t,e){return t+" "+e+(1===t?"":"s")}function Vl(){if("undefined"==typeof Uint8Array)throw new $r(Yr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ml(){if("undefined"==typeof atob)throw new $r(Yr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ul,jl,ql=(Ql.fromBase64String=function(t){ml("Blob.fromBase64String",arguments,1),El("Blob.fromBase64String","string",1,t),Ml();try{return new Ql(Ei.fromBase64String(t))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ql.fromUint8Array=function(t){if(ml("Blob.fromUint8Array",arguments,1),Vl(),!(t instanceof Uint8Array))throw Ol("Blob.fromUint8Array","Uint8Array",1,t);return new Ql(Ei.fromUint8Array(t))},Ql.prototype.toBase64=function(){return ml("Blob.toBase64",arguments,0),Ml(),this.ef.toBase64()},Ql.prototype.toUint8Array=function(){return ml("Blob.toUint8Array",arguments,0),Vl(),this.ef.toUint8Array()},Ql.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ql.prototype.isEqual=function(t){return this.ef.isEqual(t.ef)},Ql),Fl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $r(Yr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(El("FieldPath","string",e,t[e]),0===t[e].length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.nf=new ri(t)},Bl=(n(Wl,jl=Fl),Wl.documentId=function(){return new Wl(ri.L().N())},Wl.prototype.isEqual=function(t){if(!(t instanceof Wl))throw Ol("isEqual","FieldPath",1,t);return this.nf.isEqual(t.nf)},Wl),Gl=new RegExp("[~\\*/\\[\\]]"),zl=function(){this.sf=this},Hl=(n(Kl,Ul=zl),Kl.prototype.rf=function(t){if(2!==t.hf)throw 1===t.hf?t.af(this.if+"() can only appear at the top level of your update data"):t.af(this.if+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Kl.prototype.isEqual=function(t){return t instanceof Kl},Kl);function Kl(t){var e=this;return(e=Ul.call(this)||this).if=t,e}function Wl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return jl.call(this,t)||this}function Ql(t){Ml(),this.ef=t}function Xl(t,e,n){return new Tp({hf:3,uf:e.settings.uf,methodName:t.if,cf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Yl,$l,Jl,Zl,tp,ep,np=(n(Ep,ep=zl),Ep.prototype.rf=function(t){return new Ts(t.path,new as)},Ep.prototype.isEqual=function(t){return t instanceof Ep},Ep),rp=(n(bp,tp=zl),bp.prototype.rf=function(t){var e=Xl(this,t,!0),n=this.lf.map(function(t){return xp(t,e)}),r=new hs(n);return new Ts(t.path,r)},bp.prototype.isEqual=function(t){return this===t},bp),ip=(n(wp,Zl=zl),wp.prototype.rf=function(t){var e=Xl(this,t,!0),n=this.lf.map(function(t){return xp(t,e)}),r=new ds(n);return new Ts(t.path,r)},wp.prototype.isEqual=function(t){return this===t},wp),op=(n(mp,Jl=zl),mp.prototype.rf=function(t){var e=new ms(t.serializer,Vo(t.serializer,this._f));return new Ts(t.path,e)},mp.prototype.isEqual=function(t){return this===t},mp),sp=(n(gp,$l=zl),gp.delete=function(){return gl("FieldValue.delete",arguments),new up(new Hl("FieldValue.delete"))},gp.serverTimestamp=function(){return gl("FieldValue.serverTimestamp",arguments),new up(new np("FieldValue.serverTimestamp"))},gp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wl("FieldValue.arrayUnion",arguments,1),new up(new rp("FieldValue.arrayUnion",t))},gp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wl("FieldValue.arrayRemove",arguments,1),new up(new ip("FieldValue.arrayRemove",t))},gp.increment=function(t){return El("FieldValue.increment","number",1,t),ml("FieldValue.increment",arguments,1),new up(new op("FieldValue.increment",t))},gp),up=(n(vp,Yl=sp),vp.prototype.rf=function(t){return this.sf.rf(t)},vp.prototype.isEqual=function(t){return t instanceof vp&&this.sf.isEqual(t.sf)},vp),ap=(Object.defineProperty(yp.prototype,"latitude",{get:function(){return this.ff},enumerable:!1,configurable:!0}),Object.defineProperty(yp.prototype,"longitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),yp.prototype.isEqual=function(t){return this.ff===t.ff&&this.df===t.df},yp.prototype.T=function(t){return Mr(this.ff,t.ff)||Mr(this.df,t.df)},yp),hp=/^__.*__$/,cp=function(t,e,n){this.wf=t,this.Tf=e,this.Ef=n},fp=(dp.prototype.If=function(t,e){var n=[];return null!==this.Le?n.push(new Ms(t,this.data,this.Le,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},dp),lp=(pp.prototype.If=function(t,e){var n=[new Ms(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},pp);function pp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function dp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function yp(t,e){if(ml("GeoPoint",arguments,2),El("GeoPoint","number",1,t),El("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $r(Yr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $r(Yr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ff=t,this.df=e}function vp(t){var e=this;return(e=Yl.call(this)||this).sf=t,e.if=t.if,e}function gp(){return $l.call(this)||this}function mp(t,e){var n=this;return(n=Jl.call(this)||this).if=t,n._f=e,n}function wp(t,e){var n=this;return(n=Zl.call(this)||this).if=t,n.lf=e,n}function bp(t,e){var n=this;return(n=tp.call(this)||this).if=t,n.lf=e,n}function Ep(t){var e=this;return(e=ep.call(this)||this).if=t,e}function Ip(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Tp=(Object.defineProperty(_p.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(_p.prototype,"hf",{get:function(){return this.settings.hf},enumerable:!1,configurable:!0}),_p.prototype.Af=function(t){return new _p(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},_p.prototype.Rf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.Pf(t),r},_p.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.mf(),r},_p.prototype.Vf=function(t){return this.Af({path:void 0,cf:!0})},_p.prototype.af=function(t){return Mp(t,this.settings.methodName,this.settings.yf||!1,this.path,this.settings.uf)},_p.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},_p.prototype.mf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Pf(this.path.get(t))},_p.prototype.Pf=function(t){if(0===t.length)throw this.af("Document fields must not be empty");if(Ip(this.hf)&&hp.test(t))throw this.af('Document fields cannot begin and end with "__"')},_p),Np=(Ap.prototype.pf=function(t,e,n,r){return void 0===r&&(r=!1),new Tp({hf:t,methodName:e,uf:n,path:ri.$(),cf:!1,yf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Ap);function Ap(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||rl(t)}function _p(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mf(),this.fieldTransforms=i||[],this.Le=o||[]}function Sp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.pf(o.merge||o.mergeFields?2:0,e,n,i);Lp("Data must be an object, but it was:",s,r);var u,a,h=Op(r,s);if(o.merge)u=new Is(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Fl)d=p.nf;else{if("string"!=typeof p)throw Rr();d=Vp(e,p,n)}if(!s.contains(d))throw new $r(Yr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Up(c,d)||c.push(d)}u=new Is(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new fp(new Xs(h),u,a)}function kp(t,o,s,e){var u=t.pf(1,o,s);Lp("Data must be an object, but it was:",u,e);var a=[],h=new Ys;zr(e,function(t,e){var n,r=Vp(o,t,s),i=u.gf(r);e instanceof zl&&e.sf instanceof Hl?a.push(r):null!=(n=xp(e,i))&&(a.push(r),h.set(r,n))});var n=new Is(a);return new lp(h.Ge(),n,u.fieldTransforms)}function Dp(t,e,n,r,i,o){var s=t.pf(1,e,n),u=[Cp(e,r,n)],a=[i];if(o.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Cp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Ys,v=u.length-1;0<=v;--v){Up(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof zl&&f.sf instanceof Hl?d.push(c):null!=(p=xp(f,l))&&(d.push(c),y.set(c,p)))}var g=new Is(d);return new lp(y.Ge(),g,s.fieldTransforms)}function Pp(t,e,n,r){return void 0===r&&(r=!1),xp(n,t.pf(r?4:3,e))}function xp(s,t){if(Rp(s))return Lp("Unsupported field value:",t,s),Op(s,t);if(s instanceof zl)return function(t,e){if(!Ip(e.hf))throw e.af(t.if+"() can only be used with update() and set()");if(!e.path)throw e.af(t.if+"() is not currently supported inside arrays");var n=t.rf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.cf&&4!==t.hf)throw t.af("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=xp(i[r],t.Vf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Jr.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof Jr){var r=new Jr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof ap)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ql)return{bytesValue:Uo(e.serializer,t)};if(t instanceof cp){var i=e.s,o=t.wf;if(!o.isEqual(i))throw e.af("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:qo(t.wf||e.s,t.Tf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.af("Unsupported field value: "+Dl(t))}(s,t)}function Op(t,r){var i={};return Hr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):zr(t,function(t,e){var n=xp(e,r.Rf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Rp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Jr||t instanceof ap||t instanceof ql||t instanceof cp||t instanceof zl)}function Lp(t,e,n){if(!Rp(n)||!kl(n)){var r=Dl(n);throw"an object"===r?e.af(t+" a custom object"):e.af(t+" "+r)}}function Cp(t,e,n){if(e instanceof Fl)return e.nf;if("string"==typeof e)return Vp(t,e);throw Mp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Vp(t,e,n){try{return function(e){if(0<=e.search(Gl))throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Bl.bind.apply(Bl,i([void 0],e.split("."))))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).nf}catch(e){throw Mp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Mp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new $r(Yr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Up(t,e){return t.some(function(t){return t.isEqual(e)})}var jp=(zp.prototype.Cf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new $r(Yr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ko((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Bo(i.serializer,t)})},[4,i.Wa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),r=jo(e.found.updateTime),i=new Xs({mapValue:{fields:e.found.fields}});return new ou(n,r,i,{})}(e,n):"missing"in n?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);var n=Go(t,e.missing),r=jo(e.readTime);return new su(n,r)}(e,n):Rr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Lr(!!e),s.push(e)}),s)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof su||t instanceof ou?n.Nf(t):Rr()}),e)]}})})},zp.prototype.set=function(t,e){this.write(e.If(t,this.Ue(t))),this.Df.add(t)},zp.prototype.update=function(t,e){try{this.write(e.If(t,this.kf(t)))}catch(t){this.Sf=t}this.Df.add(t)},zp.prototype.delete=function(t){this.write([new Ws(t,this.Ue(t))]),this.Df.add(t)},zp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Sf)throw this.Sf;return e=this.bf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ii(ei.k(e));r.mutations.push(new Qs(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Xo(e.serializer,t)})},[4,e.Ua("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.vf=!0,[2]}})})},zp.prototype.Nf=function(t){var e;if(t instanceof ou)e=t.version;else{if(!(t instanceof su))throw Rr();e=Zr.min()}var n=this.bf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $r(Yr.ABORTED,"Document version changed between two reads.")}else this.bf.set(t.key.toString(),e)},zp.prototype.Ue=function(t){var e=this.bf.get(t.toString());return!this.Df.has(t)&&e?_s.updateTime(e):_s.We()},zp.prototype.kf=function(t){var e=this.bf.get(t.toString());if(this.Df.has(t)||!e)return _s.exists(!0);if(e.isEqual(Zr.min()))throw new $r(Yr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},zp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},zp.prototype.Ff=function(){},zp),qp=(Gp.prototype.run=function(){this.$f()},Gp.prototype.$f=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new jp(this.eu),(n=this.Mf(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.Of(t)})})}).catch(function(t){r.Of(t)}),[2]})})})},Gp.prototype.Mf=function(t){try{var e=this.updateFunction(t);return!pi(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},Gp.prototype.Of=function(t){var e=this;0<this.xf&&this.Lf(t)?(--this.xf,this.ao.Zi(function(){return e.$f(),Promise.resolve()})):this.lo.reject(t)},Gp.prototype.Lf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!ki(e)},Gp),Fp=(Bp.prototype.start=function(t,e,n,r){var i=this;this.Bf(),this.y_=t;var o=new pa,s=!1;return this.credentials.ea(function(t){return s?void i.ao.er(function(){return i.tl.Uu(t)}):(s=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.Uf(e,n,r,t,o).then(i.qf.resolve,i.qf.reject))}),this.ao.Zi(function(){return i.qf.promise}),o.promise},Bp.prototype.enableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.tl.enableNetwork()})},Bp.prototype.Uf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ao:this.ao,y_:this.y_,clientId:this.clientId,credentials:this.credentials,W_:u,nl:100,j_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.el=i.el,this.tu=i.tu,this.q_=i.q_,this.eu=o.eu,this.tl=o.tl,this.vu=o.vu,this.Wf=o.J_,this.persistence.Yi(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Qf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Uf(new ul,new hl,{Q_:!1},u,a))];case 4:return[2]}})})},Bp.prototype.Qf=function(t){return"FirebaseError"===t.name?t.code===Yr.FAILED_PRECONDITION||t.code===Yr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Bp.prototype.Bf=function(){if(this.ao.yo)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},Bp.prototype.disableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.tl.disableNetwork()})},Bp.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.tl._r()];case 1:return t.sent(),[4,this.el._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.na(),[2]}})})})},Bp.prototype.waitForPendingWrites=function(){var t=this;this.Bf();var e=new pa;return this.ao.Zi(function(){return t.vu.yl(e)}),e.promise},Bp.prototype.listen=function(t,e,n){var r=this;this.Bf();var i=new yl(n),o=new Sf(t,i,e);return this.ao.Zi(function(){return r.Wf.listen(o)}),function(){i.tf(),r.ao.Zi(function(){return r.Wf.pu(o)})}},Bp.prototype.jf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new pa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.Nh(s)];case 1:return(e=t.sent())instanceof ou?i.resolve(e):e instanceof su?i.resolve(null):i.reject(new $r(Yr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=nc(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ao,this.tu,e))]}})})},Bp.prototype.Kf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new pa,s=Hp(e,n,yu(r.path),{includeMetadataChanges:!0,jl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new $r(Yr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new $r(Yr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Bp.prototype.Gf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new pa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.$h(h,!0)];case 1:return e=t.sent(),n=new af(h,e.Mh),r=n.Uc(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=nc(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ao,this.tu,e))]}})})},Bp.prototype.zf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new pa,s=Hp(e,n,r,{includeMetadataChanges:!0,jl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new $r(Yr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Bp.prototype.write=function(t){var e=this;this.Bf();var n=new pa;return this.ao.Zi(function(){return e.vu.write(t,n)}),n.promise},Bp.prototype.s=function(){return this.y_.s},Bp.prototype.Ml=function(t){var e=this;this.Bf();var n=new yl(t);return this.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ml(n)]})})}),function(){n.tf(),e.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ol(n)]})})})}},Object.defineProperty(Bp.prototype,"Hf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Bp.prototype.transaction=function(t){var e=this;this.Bf();var n=new pa;return this.ao.Zi(function(){return new qp(e.ao,e.eu,t,n).run(),Promise.resolve()}),n.promise},Bp);function Bp(t,e){this.credentials=t,this.ao=e,this.clientId=Cr.t(),this.qf=new pa}function Gp(t,e,n,r){this.ao=t,this.eu=e,this.updateFunction=n,this.lo=r,this.xf=5,this.Po=new da(this.ao,"transaction_retry")}function zp(t){this.eu=t,this.bf=new Map,this.mutations=[],this.vf=!1,this.Sf=null,this.Df=new Set}function Hp(t,e,n,r,i){var o=new yl(i),s=new Sf(n,o,r);return t.Zi(function(){return e.listen(s)}),function(){o.tf(),t.Zi(function(){return e.pu(s)})}}var Kp,Wp,Qp=(ld.prototype.Xf=function(t){switch(vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return To(t.integerValue||t.doubleValue);case 3:return this.Zf(t.timestampValue);case 4:return this.td(t);case 5:return t.stringValue;case 6:return new ql(No(t.bytesValue));case 7:return this.ed(t.referenceValue);case 8:return this.nd(t.geoPointValue);case 9:return this.sd(t.arrayValue);case 10:return this.rd(t.mapValue);default:throw Rr()}},ld.prototype.rd=function(t){var n=this,r={};return zr(t.fields||{},function(t,e){r[t]=n.Xf(e)}),r},ld.prototype.nd=function(t){return new ap(To(t.latitude),To(t.longitude))},ld.prototype.sd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Xf(t)})},ld.prototype.td=function(t){switch(this.Yf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.Xf(e);case"estimate":return this.Zf(po(t));default:return null}},ld.prototype.Zf=function(t){var e=Io(t),n=new Jr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},ld.prototype.ed=function(t){var e=ei.k(t);Lr(rs(e));var n=new Fr(e.get(1),e.get(3)),r=new ii(e.V(5));return n.isEqual(this.s)||Pr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Jf(r)},ld),Xp=sc.Xo,Yp=(fd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},fd),$p=(Object.defineProperty(cd.prototype,"Ed",{get:function(){return this.Id||(this.Id=new Np(this.wf,this.Td.ignoreUndefinedProperties)),this.Id},enumerable:!1,configurable:!0}),cd.prototype.settings=function(t){ml("Firestore.settings",arguments,1),El("Firestore.settings","object",1,t);var e=new Yp(t);if(this._d&&!this.Td.isEqual(e))throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Td=e).credentials&&(this.wd=function(t){if(!t)return new Sc;switch(t.type){case"gapi":var e=t.md;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pc(e,t.aa||"0");case"provider":return t.md;default:throw new $r(Yr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},cd.prototype.enableNetwork=function(){return this.ld(),this._d.enableNetwork()},cd.prototype.disableNetwork=function(){return this.ld(),this._d.disableNetwork()},cd.prototype.enablePersistence=function(t){var e,n;if(this._d)throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Pr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new $r(Yr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ad(this.od,this.hd,{Q_:!0,cacheSizeBytes:this.Td.cacheSizeBytes,synchronizeTabs:r,Di:i})},cd.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this._d&&!this._d.Hf)throw new $r(Yr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new pa,[2,(this.ud.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.od.clearPersistence(this.wf,this.dd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},cd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(cd.prototype,"Rd",{get:function(){return this.ld(),this._d.Hf},enumerable:!1,configurable:!0}),cd.prototype.waitForPendingWrites=function(){return this.ld(),this._d.waitForPendingWrites()},cd.prototype.onSnapshotsInSync=function(t){if(this.ld(),dl(t))return this._d.Ml(t);El("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this._d.Ml(e)},cd.prototype.ld=function(){return this._d||this.Ad(new ul,new hl,{Q_:!1}),this._d},cd.prototype.Pd=function(){return new qr(this.wf,this.dd,this.Td.host,this.Td.ssl,this.Td.forceLongPolling)},cd.prototype.Ad=function(t,e,n){var r=this.Pd();return this._d=new Fp(this.wd,this.ud),this._d.start(r,t,e,n)},cd.fd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $r(Yr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $r(Yr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Fr(n)},Object.defineProperty(cd.prototype,"app",{get:function(){if(!this.ad)throw new $r(Yr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ad},enumerable:!1,configurable:!0}),cd.prototype.collection=function(t){return ml("Firestore.collection",arguments,1),El("Firestore.collection","non-empty string",1,t),this.ld(),new bd(ei.k(t),this,null)},cd.prototype.doc=function(t){return ml("Firestore.doc",arguments,1),El("Firestore.doc","non-empty string",1,t),this.ld(),td.gd(ei.k(t),this,null)},cd.prototype.collectionGroup=function(t){if(ml("Firestore.collectionGroup",arguments,1),El("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ld(),new md((e=t,new lu(ei.$(),e)),this,null);var e},cd.prototype.runTransaction=function(e){var n=this;return ml("Firestore.runTransaction",arguments,1),El("Firestore.runTransaction","function",1,e),this.ld().transaction(function(t){return e(new Jp(n,t))})},cd.prototype.batch=function(){return this.ld(),new Zp(this)},Object.defineProperty(cd,"logLevel",{get:function(){switch(kr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),cd.setLogLevel=function(t){ml("Firestore.setLogLevel",arguments,1),_l("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Sr.setLogLevel(t)},cd.prototype.Vd=function(){return this.Td.timestampsInSnapshots},cd),Jp=(hd.prototype.get=function(t){var n=this;ml("Transaction.get",arguments,1);var r=Sd("Transaction.get",t,this.yd);return this.pd.Cf([r.Tf]).then(function(t){if(!t||1!==t.length)return Rr();var e=t[0];if(e instanceof su)return new nd(n.yd,r.Tf,null,!1,!1,r.Ef);if(e instanceof ou)return new nd(n.yd,r.Tf,e,!1,!1,r.Ef);throw Rr()})},hd.prototype.set=function(t,e,n){bl("Transaction.set",arguments,2,3);var r=Sd("Transaction.set",t,this.yd);n=Nd("Transaction.set",n);var i=kd(r.Ef,e,n),o=Sp(this.yd.Ed,"Transaction.set",r.Tf,i,null!==r.Ef,n);return this.pd.set(r.Tf,o),this},hd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Bl?(wl("Transaction.update",arguments,3),r=Sd("Transaction.update",t,this.yd),Dp(this.yd.Ed,"Transaction.update",r.Tf,e,n,o)):(ml("Transaction.update",arguments,2),r=Sd("Transaction.update",t,this.yd),kp(this.yd.Ed,"Transaction.update",r.Tf,e)),this.pd.update(r.Tf,i),this},hd.prototype.delete=function(t){ml("Transaction.delete",arguments,1);var e=Sd("Transaction.delete",t,this.yd);return this.pd.delete(e.Tf),this},hd),Zp=(ad.prototype.set=function(t,e,n){bl("WriteBatch.set",arguments,2,3),this.Sd();var r=Sd("WriteBatch.set",t,this.yd);n=Nd("WriteBatch.set",n);var i=kd(r.Ef,e,n),o=Sp(this.yd.Ed,"WriteBatch.set",r.Tf,i,null!==r.Ef,n);return this.bd=this.bd.concat(o.If(r.Tf,_s.We())),this},ad.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Sd(),i="string"==typeof e||e instanceof Bl?(wl("WriteBatch.update",arguments,3),r=Sd("WriteBatch.update",t,this.yd),Dp(this.yd.Ed,"WriteBatch.update",r.Tf,e,n,o)):(ml("WriteBatch.update",arguments,2),r=Sd("WriteBatch.update",t,this.yd),kp(this.yd.Ed,"WriteBatch.update",r.Tf,e)),this.bd=this.bd.concat(i.If(r.Tf,_s.exists(!0))),this},ad.prototype.delete=function(t){ml("WriteBatch.delete",arguments,1),this.Sd();var e=Sd("WriteBatch.delete",t,this.yd);return this.bd=this.bd.concat(new Ws(e.Tf,_s.We())),this},ad.prototype.commit=function(){return this.Sd(),this.vd=!0,0<this.bd.length?this.yd.ld().write(this.bd):Promise.resolve()},ad.prototype.Sd=function(){if(this.vd)throw new $r(Yr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ad),td=(n(ud,Wp=cp),ud.gd=function(t,e,n){if(t.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new ud(new ii(t),e,n)},Object.defineProperty(ud.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"parent",{get:function(){return new bd(this.Tf.path.p(),this.firestore,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"path",{get:function(){return this.Tf.path.N()},enumerable:!1,configurable:!0}),ud.prototype.collection=function(t){if(ml("DocumentReference.collection",arguments,1),El("DocumentReference.collection","non-empty string",1,t),!t)throw new $r(Yr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ei.k(t);return new bd(this.Tf.path.child(e),this.firestore,null)},ud.prototype.isEqual=function(t){if(!(t instanceof ud))throw Ol("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Tf.isEqual(t.Tf)&&this.Ef===t.Ef},ud.prototype.set=function(t,e){bl("DocumentReference.set",arguments,1,2),e=Nd("DocumentReference.set",e);var n=kd(this.Ef,t,e),r=Sp(this.firestore.Ed,"DocumentReference.set",this.Tf,n,null!==this.Ef,e);return this._d.write(r.If(this.Tf,_s.We()))},ud.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Bl?(wl("DocumentReference.update",arguments,2),Dp(this.firestore.Ed,"DocumentReference.update",this.Tf,t,e,r)):(ml("DocumentReference.update",arguments,1),kp(this.firestore.Ed,"DocumentReference.update",this.Tf,t)),this._d.write(n.If(this.Tf,_s.exists(!0)))},ud.prototype.delete=function(){return ml("DocumentReference.delete",arguments,0),this._d.write([new Ws(this.Tf,_s.We())])},ud.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];bl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||dl(i[u])||(xl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Nl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};dl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(El("DocumentReference.onSnapshot","function",u,i[u]),Il("DocumentReference.onSnapshot","function",u+1,i[u+1]),Il("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Dd(t))},error:i[u+1],complete:i[u+2]};return this._d.listen(yu(this.Tf.path),h,c)},ud.prototype.get=function(t){var e=this;bl("DocumentReference.get",arguments,0,1),_d("DocumentReference.get",t);var n=this.firestore.ld();return t&&"cache"===t.source?n.jf(this.Tf).then(function(t){return new nd(e.firestore,e.Tf,t,!0,t instanceof ou&&t.Ke,e.Ef)}):n.Kf(this.Tf,t).then(function(t){return e.Dd(t)})},ud.prototype.withConverter=function(t){return new ud(this.Tf,this.firestore,t)},ud.prototype.Dd=function(t){var e=t.docs.get(this.Tf);return new nd(this.firestore,this.Tf,e,t.fromCache,t.hasPendingWrites,this.Ef)},ud),ed=(sd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},sd),nd=(od.prototype.data=function(t){var e=this;if(bl("DocumentSnapshot.data",arguments,0,1),t=Ad("DocumentSnapshot.data",t),this.Cd){if(this.Ef){var n=new rd(this.yd,this.Tf,this.Cd,this.Fd,this.Nd,null);return this.Ef.fromFirestore(n,t)}return new Qp(this.yd.wf,this.yd.Vd(),t.serverTimestamps||"none",function(t){return new td(t,e.yd,null)}).Xf(this.Cd.Ze())}},od.prototype.get=function(t,e){var n=this;if(bl("DocumentSnapshot.get",arguments,1,2),e=Ad("DocumentSnapshot.get",e),this.Cd){var r=this.Cd.data().field(Cp("DocumentSnapshot.get",t,this.Tf));if(null!==r)return new Qp(this.yd.wf,this.yd.Vd(),e.serverTimestamps||"none",function(t){return new td(t,n.yd,n.Ef)}).Xf(r)}},Object.defineProperty(od.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"ref",{get:function(){return new td(this.Tf,this.yd,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"exists",{get:function(){return null!==this.Cd},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"metadata",{get:function(){return new ed(this.Nd,this.Fd)},enumerable:!1,configurable:!0}),od.prototype.isEqual=function(t){if(!(t instanceof od))throw Ol("isEqual","DocumentSnapshot",1,t);return this.yd===t.yd&&this.Fd===t.Fd&&this.Tf.isEqual(t.Tf)&&(null===this.Cd?null===t.Cd:this.Cd.isEqual(t.Cd))&&this.Ef===t.Ef},od),rd=(n(id,Kp=nd),id.prototype.data=function(t){return Kp.prototype.data.call(this,t)},id);function id(){return null!==Kp&&Kp.apply(this,arguments)||this}function od(t,e,n,r,i,o){this.yd=t,this.Tf=e,this.Cd=n,this.Fd=r,this.Nd=i,this.Ef=o}function sd(t,e){this.hasPendingWrites=t,this.fromCache=e}function ud(t,e,n){var r=this;return(r=Wp.call(this,e.wf,t,n)||this).Tf=t,r.firestore=e,r.Ef=n,r._d=r.firestore.ld(),r}function ad(t){this.yd=t,this.bd=[],this.vd=!1}function hd(t,e){this.yd=t,this.pd=e}function cd(t,e,n,r){var i=this;if(void 0===n&&(n=new ul),void 0===r&&(r=new hl),this.od=n,this.hd=r,this.ad=null,this.ud=new Zh,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ld(),[4,this._d.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ad=o,this.wf=cd.fd(o),this.dd=o.name,this.wd=new kc(e)}else{var s=t;if(!s.projectId)throw new $r(Yr.INVALID_ARGUMENT,"Must provide projectId");this.wf=new Fr(s.projectId,s.database),this.dd="[DEFAULT]",this.wd=new Sc}this.Td=new Yp({})}function fd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new $r(Yr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Tl("settings","non-empty string","host",t.host),this.host=t.host,Nl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(xl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Nl("settings","object","credentials",t.credentials),this.credentials=t.credentials,Nl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Nl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Pr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Pr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Nl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=sc.th;else{if(t.cacheSizeBytes!==Xp&&t.cacheSizeBytes<sc.Zo)throw new $r(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+sc.Zo);this.cacheSizeBytes=t.cacheSizeBytes}Nl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function ld(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Yf=n,this.Jf=r}function pd(t,e,n){if("string"==typeof n){if(""===n)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!vu(e)&&-1!==n.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ei.k(n));if(!ii.W(r))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new ii(r))}if(n instanceof cp)return Ao(t,n.Tf);throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dl(n)+".")}function dd(t,e){if(!Array.isArray(t)||0===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function yd(t,e,n){if(!n.isEqual(e))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function vd(t){if(t.an()&&0===t.tn.length)throw new $r(Yr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var gd,md=(Td.prototype.where=function(t,e,n){ml("Query.where",arguments,3),Pl("Query.where",3,n);var r,i,o=_l("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Cp("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.O()){if("array-contains"===o||"array-contains-any"===o)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){dd(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var f=c[h];a.push(pd(r,t,f))}u={arrayValue:{values:a}}}else u=pd(r,t,s)}else"in"!==o&&"array-contains-any"!==o||dd(s,o),u=Pp(n,e,s,"in"===o);var l=ku.create(i,o,u);return function(t,e){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&yd(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}(t,l),l}(this.kd,"Query.where",this.firestore.Ed,this.firestore.wf,s,o,n);return new Td((r=this.kd,i=r.filters.concat([u]),new lu(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},Td.prototype.orderBy=function(t,e){var n;if(bl("Query.orderBy",arguments,1,2),Il("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $r(Yr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Cp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new Xu(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&yd(0,o,i.field),s}(this.kd,o,n);return new Td((r=this.kd,i=r.tn.concat([s]),new lu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},Td.prototype.limit=function(t){return ml("Query.limit",arguments,1),El("Query.limit","number",1,t),Rl("Query.limit",1,t),new Td(wu(this.kd,t,"F"),this.firestore,this.Ef)},Td.prototype.limitToLast=function(t){return ml("Query.limitToLast",arguments,1),El("Query.limitToLast","number",1,t),Rl("Query.limitToLast",1,t),new Td(wu(this.kd,t,"L"),this.firestore,this.Ef)},Td.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wl("Query.startAt",arguments,1);var r=this.xd("Query.startAt",t,e,!0);return new Td(bu(this.kd,r),this.firestore,this.Ef)},Td.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wl("Query.startAfter",arguments,1);var r=this.xd("Query.startAfter",t,e,!1);return new Td(bu(this.kd,r),this.firestore,this.Ef)},Td.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wl("Query.endBefore",arguments,1);var r=this.xd("Query.endBefore",t,e,!0);return new Td(Eu(this.kd,r),this.firestore,this.Ef)},Td.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wl("Query.endAt",arguments,1);var r=this.xd("Query.endAt",t,e,!1);return new Td(Eu(this.kd,r),this.firestore,this.Ef)},Td.prototype.isEqual=function(t){if(!(t instanceof Td))throw Ol("isEqual","Query",1,t);return this.firestore===t.firestore&&Iu(this.kd,t.kd)&&this.Ef===t.Ef},Td.prototype.withConverter=function(t){return new Td(this.kd,this.firestore,t)},Td.prototype.xd=function(c,t,e,n){if(Pl(c,1,t),t instanceof nd)return ml(c,i([t],e),1),function(t,e,n,r){if(!n)throw new $r(Yr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=gu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new $r(Yr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new qu(i,r)}(this.kd,this.firestore.wf,t.Cd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new $r(Yr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!vu(t)&&-1!==h.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ei.k(h));if(!ii.W(c))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new ii(c);u.push(Ao(e,f))}else{var l=Pp(n,r,h);u.push(l)}}return new qu(u,o)}(this.kd,this.firestore.wf,this.firestore.Ed,c,r,n)},Td.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];bl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||dl(i[a])||(xl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Nl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),dl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(El("Query.onSnapshot","function",a,i[a]),Il("Query.onSnapshot","function",a+1,i[a+1]),Il("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new wd(r.firestore,r.kd,t,r.Ef))},error:i[a+1],complete:i[a+2]};return vd(this.kd),this.firestore.ld().listen(this.kd,u,h)},Td.prototype.get=function(t){var e=this;bl("Query.get",arguments,0,1),_d("Query.get",t),vd(this.kd);var n=this.firestore.ld();return(t&&"cache"===t.source?n.Gf(this.kd):n.zf(this.kd,t)).then(function(t){return new wd(e.firestore,e.kd,t,e.Ef)})},Td),wd=(Object.defineProperty(Id.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"empty",{get:function(){return this.Md.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"size",{get:function(){return this.Md.docs.size},enumerable:!1,configurable:!0}),Id.prototype.forEach=function(e,n){var r=this;bl("QuerySnapshot.forEach",arguments,1,2),El("QuerySnapshot.forEach","function",1,e),this.Md.docs.forEach(function(t){e.call(n,r.qd(t,r.metadata.fromCache,r.Md.Lt.has(t.key)))})},Object.defineProperty(Id.prototype,"query",{get:function(){return new md(this.$d,this.yd,this.Ef)},enumerable:!1,configurable:!0}),Id.prototype.docChanges=function(t){t&&(xl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Nl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Md.Bt)throw new $r(Yr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Od&&this.Ld===e||(this.Od=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Md,e,this.qd.bind(this)),this.Ld=e),this.Od},Id.prototype.isEqual=function(t){if(!(t instanceof Id))throw Ol("isEqual","QuerySnapshot",1,t);return this.yd===t.yd&&Iu(this.$d,t.$d)&&this.Md.isEqual(t.Md)&&this.Ef===t.Ef},Id.prototype.qd=function(t,e,n){return new rd(this.yd,t.key,t,e,n,this.Ef)},Id),bd=(n(Ed,gd=md),Object.defineProperty(Ed.prototype,"id",{get:function(){return this.kd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"parent",{get:function(){var t=this.kd.path.p();return t._()?null:new td(new ii(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"path",{get:function(){return this.kd.path.N()},enumerable:!1,configurable:!0}),Ed.prototype.doc=function(t){bl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Cr.t()),El("CollectionReference.doc","non-empty string",1,t);var e=ei.k(t);return td.gd(this.kd.path.child(e),this.firestore,this.Ef)},Ed.prototype.add=function(t){ml("CollectionReference.add",arguments,1),El("CollectionReference.add","object",1,this.Ef?this.Ef.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Ed.prototype.withConverter=function(t){return new Ed(this.Bd,this.firestore,t)},Ed);function Ed(t,e,n){var r=this;if(((r=gd.call(this,yu(t),e,n)||this).Bd=t).length%2!=1)throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function Id(t,e,n,r){this.yd=t,this.$d=e,this.Md=n,this.Ef=r,this.Od=null,this.Ld=null,this.metadata=new ed(n.hasPendingWrites,n.fromCache)}function Td(t,e,n){this.kd=t,this.firestore=e,this.Ef=n}function Nd(t,e){if(void 0===e)return{merge:!1};if(xl(t,e,["merge","mergeFields"]),Nl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Dl(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Dl(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Bl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new $r(Yr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ad(t,e){return void 0===e?{}:(xl(t,e,["serverTimestamps"]),Al(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function _d(t,e){Il(t,"object",1,e),e&&(xl(t,e,["source"]),Al(t,0,"source",e.source,["default","server","cache"]))}function Sd(t,e,n){if(e instanceof cp){if(e.firestore!==n)throw new $r(Yr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ol(t,"DocumentReference",1,e)}function kd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Dd,Pd={Firestore:$p,GeoPoint:ap,Timestamp:Jr,Blob:ql,Transaction:Jp,WriteBatch:Zp,DocumentReference:td,DocumentSnapshot:nd,Query:md,QueryDocumentSnapshot:rd,QuerySnapshot:wd,CollectionReference:bd,FieldPath:Bl,FieldValue:sp,setLogLevel:$p.setLogLevel,CACHE_SIZE_UNLIMITED:Xp};(Dd=xd).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new hl,i=new al(r),new $p(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Pd))),Dd.registerVersion("@firebase/firestore","1.16.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
